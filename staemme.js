var staemme;(()=>{"use strict";var e={595:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(601),a=n.n(i),r=n(314),o=n.n(r)()(a());o.push([e.id,".sta-login-header {\n    width: 100%;\n}\n\n.sta-login-parent {\n    display: flex;\n    flex-wrap: wrap;\n}\n\n.sta-login-item {\n    display: flex;\n    width: fit-content;\n}\n",""]);const s=o},407:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(601),a=n.n(i),r=n(314),o=n.n(r)()(a());o.push([e.id,"#menuButton {\n    cursor: pointer;\n}\n\n.sta-menu-item-checkbox-first-child {\n    margin: 3px 0px 0px;\n}\n\n.sta-menu-item-checkbox {\n    margin: 1px 0px 0px;\n}\n\n.sta-menu-item-container {\n    display: flex;\n    gap: 3px;\n    align-items: center;\n    left: -5px;\n    position: relative;\n}\n\n.sta-leftUiThingyFirstChild {\n    background: transparent url(https://dsde.innogamescdn.com/asset/c045337f/graphic/index/dropdown-topleft.png) scroll left top no-repeat;\n    height: 21px;\n    width: 20px;\n    left: -5px;\n    position: relative;\n}\n\n.sta-leftUiThingy {\n    background: transparent url(https://dsde.innogamescdn.com/asset/c045337f/graphic/index/dropdown-itemleft.png) scroll left top no-repeat;\n    height: 21px;\n    width: 20px;\n    left: -5px;\n    position: relative;\n}\n\n.sta-menu-column-item-text-first-child:hover, .sta-menu-column-item-text:hover, #iconContainer:hover {\n    color: #f0d49a;\n}\n\n.sta-menu-column-item-text-first-child {\n    padding: 5px 12px 3px 6px;\n    left: -5px;\n    position: relative;\n}\n\n.sta-menu-column-item-text {\n    padding: 4px 12px 3px 6px;\n    left: -5px;\n    position: relative;\n}\n\n.sta-menu-column-item {\n    display: flex !important;\n    flex-direction: row;\n}\n\n.sta-corner {\n    left: -5px !important;\n}\n\n.sta-menu-column {\n    margin-left: 4px !important;\n    border-spacing: 0;\n}\n\n.sta-construction-building-upgradeable {\n    display: flex;\n    flex-direction: column;\n    gap: 2px;\n}\n\n.sta-construction-building-level-upgradeable {\n    background-color: #f0e2be;\n    font-weight: 700;\n    color: #603000;\n    cursor: pointer;\n    width: 22px;\n    height: 18px;\n    padding: 2px;\n    text-align: center;\n    align-content: center;\n}\n\n.sta-building-icon {\n    background-image: url(https://dsde.innogamescdn.com/asset/234518f7/graphic/screen/tableheader_bg3.png);\n    background-size: contain;\n    width: 18px;\n    height: 18px;\n    padding: 4px;\n}\n\n.sta-total-level {\n    display: flex;\n    gap: 2px;\n    width: fit-content;\n    flex-grow: 0;\n}\n\n.sta-construction-menu-buildplan {\n    display: flex;\n    flex-direction: row;\n    gap: 4px;\n}\n",""]);const s=o},718:(e,t,n)=>{n.d(t,{A:()=>g});var i=n(601),a=n.n(i),r=n(314),o=n.n(r),s=n(417),l=n.n(s),c=new URL(n(535),n.b),d=new URL(n(377),n.b),u=o()(a()),h=l()(c),p=l()(d);u.push([e.id,`.sta-container {\n    background: url(https://dsde.innogamescdn.com/asset/234518f7/graphic/index/grey-fade.png);\n    height: 100%;\n}\n\n.sta-popup {\n    transition-duration: 0.5s;\n    z-index: 15000;\n    border-radius: 16px;\n    overflow: auto;\n    padding: 10px;\n    background-color: rgb(227, 213, 179);\n    background-image: url(https://dsde.innogamescdn.com/asset/234518f7/graphic/index/main_bg.jpg);\n}\n\n.sta-nav-item {\n    color: #603000;\n    cursor: pointer;\n    width: -webkit-fill-available;\n    font-weight: 700;\n    padding: 2px 3px;\n    background-color: rgb(244, 228, 188);\n}\n\n.sta-nav-item.sta-nav-item-selected {\n    background-color: rgb(250, 220, 155);\n    color: #803000;\n}\n\n.sta-logs {\n    font-weight: 700;\n    color: #603000;\n    cursor: pointer;\n}\n\n.sta-popup-header-label {\n}\n\n.sta-popup-description {\n    flex-grow: 1;\n    flex-shrink: 1;\n    padding-left: 50px;\n    padding-right: 50px;\n    max-width: 500px;\n}\n\n.sta-logs:hover {\n    color: #e01f0f;\n}\n\n.sta-popup-header-container {\n    display: flex;\n    flex-direction: row;\n    flex-wrap: nowrap;\n    gap: 4px;\n    align-content: center;\n    margin-bottom: 25px;\n}\n\n.sta-construction-building-level-upgradeable:hover, .sta-nav-item:hover {\n    color: #e01f0f;\n}\n\n.sta-popup-content {\n    gap: 10px;\n    display: flex;\n}\n\n.sta-menu-component {\n    display: flex;\n    flex-direction: column;\n    gap: 2px;\n    position: relative;\n}\n\n.sta-labelled-input {\n    display: flex;\n    background-color: rgb(244, 228, 188);\n    padding: 2px 3px;\n    gap: 2px;\n    flex-grow: 1;\n    max-width: 500px;\n}\n\n.sta-input-label {\n    align-content: center;\n}\n\n.sta-numeric-input {\n    width: 25pt;\n}\n\n.clickable {\n    cursor: pointer;\n}\n\n.sta-menu-header {\n    font-weight: 700;\n    background-image: url(https://dsde.innogamescdn.com/asset/234518f7/graphic/screen/tableheader_bg3.png);\n    padding: 2px 3px;\n}\n\n.sta-menu-item-row {\n    display: flex;\n    gap: 2px;\n}\n\n.sta-menu-setting-label {\n    background-color: rgb(244, 228, 188);\n    padding: 2px 3px;\n    align-content: center;\n    min-width: 135px;\n}\n\n.sta-nav {\n    display: flex;\n    flex-direction: column;\n    height: fit-content;\n    width: fit-content;\n    gap: 2px;\n}\n\n.sta-fade-in {\n    animation: fadein 0.5s linear;\n    position: relative;\n}\n\n.sta-fade-out {\n    animation: fadeout 0.3s linear;\n    position: relative;\n}\n\n.sta-info {\n    background: url('https://dsde.innogamescdn.com/asset/234518f7/graphic/questionmark.png') no-repeat center;\n    background-size: 17px;\n    width: 17px;\n    height: 17px;\n    margin-top: 3px;\n    flex-shrink: 0;\n}\n\n@-webkit-keyframes fadein {\n    0% {\n        opacity: 0;\n        z-index: -1;\n        top: 50px;\n    }\n    100% {\n        opacity: 1;\n        z-index: auto;\n        top: 0px;\n    }\n}\n\n@-webkit-keyframes fadeout {\n    0% {\n        opacity: 1;\n        margin-left: 0px;\n    }\n    100% {\n        opacity: 0;\n        margin-left: -70px;\n    }\n}\n\n.sta-feature-header-premiun-icon {\n    width: 15px;\n    height: 15px;\n    margin-top: 2px;\n}\n\n.sta-feature-header-premium {\n    background-image: url(https://dsde.innogamescdn.com/asset/234518f7/graphic/screen/tableheader_bg3.png);\n    padding: 0px 3px;\n    display: flex;\n    flex-direction: row;\n    gap: 2px;\n}\n\n.sta-construction-entries {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    gap: 2px;\n}\n\n.sta-construction-plan {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    gap: 2px;\n}\n\n.sta-construction-plan-inverted {\n    flex-direction: column-reverse !important;\n}\n\n.sta-construction-plan-inverter {\n    font-weight: 700;\n    color: #603000;\n    cursor: pointer;\n}\n\n.sta-construction-plan-inverter:hover {\n    color: #e01f0f;\n}\n\n.sta-construction-entry-row {\n    display: flex;\n    flex-direction: row;\n    gap: 2px;\n    align-content: center;\n    background-color: rgb(244, 228, 188);\n    align-items: center;\n}\n\n.sta-construction-entry-icon {\n    width: 18px;\n    height: 18px;\n    padding: 2px 4px;\n}\n\n.sta-construction-entry-name {\n    font-weight: 700;\n    color: #603000;\n}\n\n.sta-construction-entry-level {\n    flex-grow: 1;\n}\n\n.sta-construction-entry-plus {\n    background: url(${h}) center no-repeat;\n    background-size: contain;\n    width: 14px;\n    height: 14px;\n    margin: 4px;\n    cursor: pointer;\n}\n\n.sta-construction-entry-minus {\n    background: url(${p}) center no-repeat;\n    background-size: contain;\n    width: 14px;\n    height: 14px;\n    margin: 4px;\n    cursor: pointer;\n}\n\n.sta-construction-entry-remove {\n    background: url(https://dsde.innogamescdn.com/asset/234518f7/graphic/delete.png) center no-repeat;\n    width: 22px;\n    height: 22px;\n    cursor: pointer;\n}\n\n.sta-construction-entry-drag {\n    background: url(https://dsde.innogamescdn.com/asset/234518f7/graphic/sorthandle.png) center no-repeat;\n    width: 22px;\n    height: 22px;\n    cursor: pointer;\n}\n\n.sta-village-list-entry {\n    display: flex;\n    background-color: #f4e4bc;\n}\n\n.sta-village-list-name {\n    font-weight: 700;\n    text-decoration: none;\n    color: #603000;\n    flex-grow: 1;\n    padding-right: 4px;\n}\n\n.sta-village-list-coords {\n    font-weight: bold;\n    text-align: right;\n    padding-right: 4px;\n}\n\n.sta-building-selector {\n    display: flex;\n    gap: 2px;\n    flex-direction: column;\n}\n`,""]);const g=u},772:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(601),a=n.n(i),r=n(314),o=n.n(r)()(a());o.push([e.id,'.sta-report-process {\n    background: url("https://dsde.innogamescdn.com/asset/62e187d5/graphic/btn/buttons.png") no-repeat 3px -248px, linear-gradient(to bottom, #947a62 0%,#7b5c3d 22%,#6c4824 30%,#6c4824 100%);\n    padding-left: 25px;\n}\n\n.sta-report-process:hover {\n    background: url("https://dsde.innogamescdn.com/asset/62e187d5/graphic/btn/buttons.png") no-repeat 3px -248px, linear-gradient(to bottom, #b69471 0%,#9f764d 22%,#8f6133 30%,#6c4d2d 100%);\n    padding-left: 25px;\n}\n',""]);const s=o},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,a,r){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(i)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(o[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);i&&o[d[0]]||(void 0!==r&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=r),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),a&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=a):d[4]="".concat(a)),t.push(d))}},t}},417:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var r={},o=[],s=0;s<e.length;s++){var l=e[s],c=i.base?l[0]+i.base:l[0],d=r[c]||0,u="".concat(c," ").concat(d);r[c]=d+1;var h=n(u),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var g=a(p,i);i.byIndex=s,t.splice(s,0,{identifier:u,updater:g,references:1})}o.push(u)}return o}function a(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,a){var r=i(e=e||[],a=a||{});return function(e){e=e||[];for(var o=0;o<r.length;o++){var s=n(r[o]);t[s].references--}for(var l=i(e,a),c=0;c<r.length;c++){var d=n(r[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}r=l}}},659:e=>{var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,a&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},535:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAilJREFUSEvtlT9oU1EUxn/nviQNNK1/QG3VQpGGahNbMUIpieIiCCI4ieDk5KRgFyeliuBScHNxcNBBKm4OpYODWIpgUayplRQsIm4qrdWa5L179FFLn4nmtU0n8Y7nnvN995x7zvmEsDOA6TyVbYkoZ0U5pqgBeWhcuTHR/eRzWLiEOXQUepvjnnNOrVwL+M4Dt/Jdo/1h8aEEeyYPthq1Qwi5CrC3+VejSU7i1SIJJeguHN7pld1HoMkKoJn4t+/7xg+Mz9ZF0POmb0fZM8MC6f8Efyxl/SUawHSc7k1Ey7HGaNRxxBY1yGSt02LRuyi7f3uB6nsT0SMGvgTtZdc4tuQZN6GfppNP56RzKrs9ip5RT44isk3RYjBAhIgq7QLxihRLwLSCXbKLYlTYCNooMIjqTUm9zl5BuRw2MGu4nxfhtqQns88UMmsAWEnIjJ/BC5SelXiv0kcVCpKazF4FLgCJVQLUcvcb5ePPxrgne1/mNtmIXgJOANWrQzWCyFYgVoHoAh8IfPLyvSxgdThWYnAZcAgnsytTlUWpKdZqPfMA6KogeCeek2sofp0L2mc3RHRL3JTH2sYWfHvosqt/0EIK/28QuK4ZQar+YH30ID1xqM067mNB2iv1oBh1e/x9U5fgLEqm3kc0GwBSkKnmJi+z1C1/IwntIl/0G8rOeZCLv4ZxcYgsd/LpdRB9/2WpfN9mMWZAleMKJVFGYkWuP98/6g9azfMD7D0FlN+wuocAAAAASUVORK5CYII="},377:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAM1BMVEUAAAAAZ/8AZv8AZv8AZ/8AZv8AZv8AZv8AZv8AZv8AZv8AZv8AZv8AZf8AZv8AZv////+Fr8V6AAAAD3RSTlMAT+jmSuTh9/37/PrgR9w26QDFAAAAAWJLR0QQlbINLAAAAAd0SU1FB+YKFBM0M4OYBZ4AAAA8SURBVDjL7dKpAQAwCEPR9ITe+2/bDYJF8CxfRAAEN1J+RKloj+oQHigGDyaUB8sKBNsaeTq73xOP4McHs4IObtg7GTsAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMTAtMjBUMTk6NTI6NTErMDA6MDASOJbCAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTEwLTIwVDE5OjUyOjUxKzAwOjAwY2UufgAAAABJRU5ErkJggg=="}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var r=t[i]={id:i,exports:{}};return e[i](r,r.exports,n),r.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.b=document.baseURI||self.location.href,n.nc=void 0;var i={};(()=>{n.r(i),n.d(i,{initStaemmeBot:()=>me});var e=n(72),t=n.n(e),a=n(825),r=n.n(a),o=n(659),s=n.n(o),l=n(56),c=n.n(l),d=n(540),u=n.n(d),h=n(113),p=n.n(h),g=n(407),m={};m.styleTagTransform=p(),m.setAttributes=c(),m.insert=s().bind(null,"head"),m.domAPI=r(),m.insertStyleElement=u();t()(g.A,m);g.A&&g.A.locals&&g.A.locals;var f=n(718),v={};v.styleTagTransform=p(),v.setAttributes=c(),v.insert=s().bind(null,"head"),v.domAPI=r(),v.insertStyleElement=u();t()(f.A,v);f.A&&f.A.locals&&f.A.locals;var b;!function(e){e.RUNNING="sta-running",e.AUTO_LOGIN_WORLD="sta-auto-login-world",e.LOGS="sta-logs",e.VILLAGE_DATA="sta-village-data",e.SCAVENGE_ENABLED="sta-scavenge-enabled",e.SCAVENGE_NEXT_RUN="sta-scavenge-next-run",e.SCAVENGE_KEEP_SPEAR="sta-scavenge-keep-spear",e.SCAVENGE_KEEP_SWORD="sta-scavenge-keep-sword",e.SCAVENGE_KEEP_AXE="sta-scavenge-keep-axe",e.SCAVENGE_KEEP_LIGHT="sta-scavenge-keep-light",e.SCAVENGE_KEEP_HEAVY="sta-scavenge-keep-heavy",e.CONSTRUCTION_ENABLED="sta-construction-enabled",e.CONSTRUCTION_BUILD_CODE="sta-construction-build-code",e.CONSTRUCTION_NEXT_RUN="sta-construction-next-run",e.CONSTRUCTION_PLAN_INVERTED="sta-construction-plan-inverted",e.REWARD_ENABLED="sta-reward-enabled",e.REWARD_NEXT_RUN="sta-reward-next-run",e.REPORT_ENABLED="sta-report-enabled",e.REPORT_ARCHIVE="sta-report-archive",e.REPORT_DB_USER="sta-report-db-user",e.REPORT_DB_PASSWORD="sta-report-db-password"}(b||(b={}));var E,x=function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};function N(e,t){localStorage.setItem(e,t)}function A(e){return localStorage.getItem(e)}function y(e){UI.SuccessMessage(e,4e3)}function w(e){UI.ErrorMessage(e,4e3)}function C(e){UI.ToolTip(e)}function _(e){return new Promise((t=>setTimeout(t,e)))}function L(){return game_data}let B=null!==(E=JSON.parse(A(b.LOGS)))&&void 0!==E?E:[];function R(...e){for(let t of e)B.push((new Date).toLocaleString("de-DE")+" - "+t);for(let e=0;e<B.length-1e3;e++)B.shift();N(b.LOGS,JSON.stringify(B))}function T(){return B}function k(e){return x(this,void 0,void 0,(function*(){return yield P(),$.get(e,(function(e){return e}))}))}function S(e,t){return x(this,arguments,void 0,(function*(e,t,n="GET",i={"Tribalwars-Ajax":1}){return yield P(),$.ajax(e,{headers:i,method:n,data:t})}))}function D(e,t){return x(this,void 0,void 0,(function*(){return yield P(),$.post(e,t,(function(e){return e}))}))}function I(e){let t=Math.floor(e-Date.now()/1e3),n=Math.floor(t/60),i=Math.floor(n/60);return t-=60*n,n-=60*i,1==i.toString().length&&(i="0"+i),1==n.toString().length&&(n="0"+n),1==t.toString().length&&(t="0"+t),i+":"+n+":"+t}let O=0;function P(){return x(this,void 0,void 0,(function*(){if(O>500){R("Reached request threshold. Logout");let e=L();window.location.href=window.location.origin+`/game.php?village=${e.village.id}&screen=&action=logout&h=${e.csrf}`}else O++,yield _(200)}))}var U=function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};class M{constructor(e){try{this.container=this.create(),this.popup=this.container.children[0],this.popup.appendChild(this.createHeader()),this.popup.appendChild(this.createContent(e))}catch(e){console.error(e)}}show(e){return U(this,void 0,void 0,(function*(){this.container.style.display="",this.popup.style.minWidth="400px",this.popup.style.maxWidth="70vw",this.popup.style.maxHeight="80vh",this.popup.style.minHeight="260px";let t=this.popup.getElementsByClassName("sta-nav")[0].children;for(let n=0;n<t.length;n++)t[n].textContent===e&&t[n].click()}))}create(){let e=document.createElement("div");e.className="popup_box_container sub-dialog sta-container",document.getElementById("ds_body").appendChild(e),e.addEventListener("click",(()=>{this.popup.style.minWidth="0px",this.popup.style.maxWidth="0vw",this.popup.style.maxHeight="0vh",this.popup.style.minHeight="0px",setTimeout((()=>{e.style.display="none"}),500)})),e.style.display="none";let t=document.createElement("div");return t.className="popup_box slim mobile show sta-popup",e.appendChild(t),t.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation()})),e}createHeader(){let e=document.createElement("div");e.className="sta-popup-header-container";let t=document.createElement("div");t.className="sta-info",t.setAttribute("data-title","Der Bot automatisiert Aufgaben im Hintergrund, ist aber nur für die Anfangsphase empfohlen. Sobald der Account Manager freigeschalten ist bitte unbedingt wechseln!"),e.appendChild(t),UI.ToolTip(t);let n=document.createElement("h2");n.className="sta-popup-header-label",n.textContent="Bot",e.appendChild(n);let i=document.createElement("div");i.className="sta-popup-description",i.textContent="Der Bot läuft nur wenn das kleines Stammessymbol neben 'Bot' in der Menüleiste blau leuchtet, \n        klicke darauf um es umzuschalten. Dann führt er alle Aufgaben aus die hier oder über das Menü aktiviert sind.",e.appendChild(i);let a=document.createElement("div");return a.className="sta-logs",a.textContent="Kopiere logs",a.setAttribute("data-title","Kopiert die letzten Log-Einträge in die Zwischenablage, vermutlich nur für den Entwickler interessant falls es Probleme gibt. Discord: Jimmy653"),a.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation();let t="";for(let e of T())t+=e+"\n";navigator.clipboard.writeText(t).then((()=>{R("Logs exported")})).catch((()=>{R("Error during export of logs")}))})),e.appendChild(a),UI.ToolTip(a),e}createContent(e){let t=document.createElement("div");return t.className="sta-popup-content",t.appendChild(this.createNavItem(e,t)),t}createNavItem(e,t){let n=document.createElement("div");n.className="sta-nav";for(let i of e){let e=document.createElement("div");e.textContent=i.getName(),e.className="sta-nav-item",e.addEventListener("click",(a=>{if(a.preventDefault(),a.stopPropagation(),!e.className.includes("sta-nav-item-selected")){for(let e=0;e<n.children.length;e++)n.children[e].className="sta-nav-item";if(e.className+=" sta-nav-item-selected",t.children.length>1){let e=t.lastChild;e.className="sta-menu-component",e.remove()}t.appendChild(i.getComponent()),i.getComponent().className="sta-menu-component sta-fade-in"}})),n.appendChild(e)}return n}}var V=function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};class G{constructor(e,t){this.subscriber=[];try{this.name=e,this.settings=t,this.component=document.createElement("div"),this.component.appendChild(this.createHeader(this.name));for(let e of this.settings)this.component.appendChild(this.createSetting(e))}catch(e){console.error(e)}}isPremium(){return this.premium}setError(e){this.error=e}isError(){return this.error}getEnabledSetting(){return this.settings[0].setting}getName(){return this.name}getComponent(){return this.component}subscribe(e){this.subscriber.push(e)}invertEnabled(){return V(this,void 0,void 0,(function*(){yield _(100);let e=!("true"===A(this.getEnabledSetting()));N(this.getEnabledSetting(),e+"");for(let t of this.subscriber)t(e)}))}createHeader(e){let t=document.createElement("div");return t.className="sta-menu-header",t.textContent=e,t}setEnabledForVillage(e,t){var n,i;n=`sta-${this.getName()}-${e}-enabled`.toLowerCase(),i=t+"",localStorage.setItem(n,i)}isVillageEnabled(e){return"true"===(t=`sta-${this.getName()}-${e}-enabled`.toLowerCase(),localStorage.getItem(t));var t}createBuildingSelector(){let e;try{e=JSON.parse(A(b.VILLAGE_DATA))}catch(e){return void R("Could not read village data")}let t=document.createElement("div");t.className="sta-building-selector";let n=document.createElement("div");n.textContent="Dorf",n.className="sta-menu-header",t.appendChild(n);for(let n of Object.keys(e)){let i=document.createElement("div");i.className="sta-village-list-entry";let a=document.createElement("input");a.type="checkbox",a.checked=this.isVillageEnabled(n),a.className="clickable";let r=this,o=e=>V(this,void 0,void 0,(function*(){e.preventDefault(),e.stopPropagation(),yield _(10),a.checked=!this.isVillageEnabled(n),r.setEnabledForVillage(n,a.checked)}));a.addEventListener("click",o);let s=document.createElement("div");s.textContent=e[n].name,s.className="sta-village-list-name clickable",s.addEventListener("click",o);let l=document.createElement("div");l.textContent=e[n].coord,l.className="sta-village-list-coords",i.append(a,s,l),t.appendChild(i)}return t}createPremium(e){this.premium=!0;let t=document.createElement("img");t.src="https://dsde.innogamescdn.com/asset/234518f7/graphic/premium/features/Premium_large.png",t.className="sta-feature-header-premiun-icon",t.setAttribute("data-title",e),UI.ToolTip(t);let n=document.createElement("div");n.className="sta-feature-header-premium",n.appendChild(t),L().features.Premium.active||(t.style.opacity="0.5");let i=this.component.children[0];i.remove(),n.appendChild(i),this.component.insertBefore(n,this.component.children[0])}createSetting(e){let t=document.createElement("div");return t.className="sta-menu-item-row",t.appendChild(this.createLabel(e.short)),t.appendChild(this.createInput(e)),t}createLabel(e){let t=document.createElement("div");return t.className="sta-menu-setting-label",t.textContent=e,t}createInput(e){let t=document.createElement("div");t.className="sta-labelled-input";let n=document.createElement("div");n.textContent=e.long,n.className="sta-input-label";let i=document.createElement("input");switch(i.className="sta-setting-input-"+e.setting,e.type){case"checkbox":i.type="checkbox",i.checked="true"===A(e.setting),i.className+=" clickable",n.className+=" clickable",i.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),this.invertEnabled()})),this.subscribe((e=>{i.checked=e})),t.addEventListener("click",(e=>{this.invertEnabled()}));break;case"numeric":i.type="text",i.inputMode="numeric",i.value=A(e.setting),i.className+=" sta-numeric-input",i.addEventListener("change",(t=>{t.preventDefault(),t.stopPropagation(),N(e.setting,i.value)}));break;case"text":i.type="text",i.value=A(e.setting),i.addEventListener("change",(t=>{t.preventDefault(),t.stopPropagation(),N(e.setting,i.value)}));break;case"password":i.type="password",i.value=A(e.setting),i.className+=" sta-password-input",i.addEventListener("change",(t=>{t.preventDefault(),t.stopPropagation(),N(e.setting,i.value)}))}return t.appendChild(i),t.appendChild(n),t}}class q{}var W=function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};class z extends G{constructor(){super("Raubzug",[{short:"Aktiviert:",long:"Sendet die Truppen in ausgewählten Dörfern auf Raubzug, wenn der Bot läuft",setting:b.SCAVENGE_ENABLED,type:"checkbox"},{short:"Speere behalten:",long:"Anzahl der Speere die in jedem Dorf zuhause bleiben",setting:b.SCAVENGE_KEEP_SPEAR,type:"numeric"},{short:"Schwerter behalten:",long:"Anzahl der Schwerter die in jedem Dorf zuhause bleiben",setting:b.SCAVENGE_KEEP_SWORD,type:"numeric"},{short:"Äxte behalten:",long:"Anzahl der Äxte die in jedem Dorf zuhause bleiben",setting:b.SCAVENGE_KEEP_AXE,type:"numeric"},{short:"Leichte behalten:",long:"Anzahl der leichten Kavallarie die in jedem Dorf zuhause bleiben",setting:b.SCAVENGE_KEEP_LIGHT,type:"numeric"},{short:"Schwere behalten:",long:"Anzahl der schweren Kavallarie die in jedem Dorf zuhause bleiben",setting:b.SCAVENGE_KEEP_HEAVY,type:"numeric"}]);try{L().features.Premium.active?this.createPremium("Premium aktiv! Raubzüge werden unauffällig im Hintergrund gesendet!"):this.createPremium("Ohne Premium funktioniert dieses Feature aktuell nicht"),this.component.appendChild(this.createBuildingSelector())}catch(e){console.error(e)}}onLoad(e,t){}preRun(){return W(this,void 0,void 0,(function*(){let e=+A(b.SCAVENGE_NEXT_RUN);return!(Date.now()<e)||(R(`${this.getName()} waiting `+I(e/1e3)),!1)}))}run(){return W(this,void 0,void 0,(function*(){if(L().features.Premium.active&&this.isPremium())return this.runPremium();w("Raubzug kann aktuell nicht ohne Premium ausgeführt werden. Spenden via Paypal könnten die Entwicklung beschleunigen ;)")}))}postRun(){N(b.CONSTRUCTION_NEXT_RUN,"0")}runFree(){return W(this,void 0,void 0,(function*(){}))}runPremium(){return W(this,void 0,void 0,(function*(){let e="game.php?&screen=place&mode=scavenge_mass",t=[],n=this;$.getAll=function(e,t,n,i){var a=0,r=0;!function o(){if(a==e.length)return void n();let s=Date.now(),l=s-r;if(l<200){return void setTimeout(o,200-l)}r=s,$.get(e[a]).done((e=>{try{t(a,e),++a,o()}catch(e){i(e)}})).fail((e=>{i(e)}))}()};let i,a=[];return $.get(e,(function(t){i=$(t).find(".paged-nav-item").length>0?parseInt($(t).find(".paged-nav-item")[$(t).find(".paged-nav-item").length-1].href.match(/page=(\d+)/)[1]):0;for(let t=0;t<=i;t++)a.push(e+"&page="+t)})).done((function(){let e="[";return $.getAll(a,((t,n)=>{let i=$(n).find('script:contains("ScavengeMassScreen")').html().match(/\{.*\:\{.*\:.*\}\}/g)[2];i&&(e+=i+",")}),(()=>{e=e.substring(0,e.length-1),e+="]";try{t=JSON.parse(e)}catch(e){return console.error(e),R("Can't work with the data"),void w("Raubzug konnte nicht geladen werden. Enthält die aktuell ausgewählte Gruppe denn Dörfer?")}return n.sendMassScavenge(t)}),(e=>{R("Error running scavenge")}))}))}))}sendMassScavenge(e){return W(this,void 0,void 0,(function*(){let t="",n=0,i=[];for(let a=0;a<e.length;a++){let r=e[a];if(!this.isVillageEnabled(r.village_id)){R(`${r.village_name} disabled for ${this.getName()}`);continue}let o=r.unit_counts_home.spear,s=r.unit_counts_home.sword,l=r.unit_counts_home.axe,c=r.unit_counts_home.light,d=r.unit_counts_home.heavy,u=[],h=[];$.each(r.options,(function(e){let t=r.options[e];t.is_locked||(u.push(t.base_id),null==t.scavenging_squad?h.push(t.base_id):(o+=t.scavenging_squad.unit_counts.spear,s+=t.scavenging_squad.unit_counts.sword,l+=t.scavenging_squad.unit_counts.axe,c+=t.scavenging_squad.unit_counts.light,d+=t.scavenging_squad.unit_counts.heavy,i.push(t.scavenging_squad.return_time)))}));let p=A(b.SCAVENGE_KEEP_SPEAR),g=A(b.SCAVENGE_KEEP_SWORD),m=A(b.SCAVENGE_KEEP_AXE),f=A(b.SCAVENGE_KEEP_LIGHT),v=A(b.SCAVENGE_KEEP_HEAVY);o-=Number.isNaN(p)?0:p,s-=Number.isNaN(g)?0:g,l-=Number.isNaN(m)?0:m,c-=Number.isNaN(f)?0:f,d-=Number.isNaN(v)?0:v;let E=r.unit_counts_home.spear,x=r.unit_counts_home.sword,N=r.unit_counts_home.axe,y=r.unit_counts_home.light,w=r.unit_counts_home.heavy;for(let e=1;e<=4;e++){let i=r.options[e];if(!h.includes(i.base_id))continue;let a=this.getWishedUnitCount(e,o,E,u.length,Number.isNaN(p)?0:p),b=this.getWishedUnitCount(e,s,x,u.length,Number.isNaN(g)?0:g),A=this.getWishedUnitCount(e,l,N,u.length,Number.isNaN(m)?0:m),C=this.getWishedUnitCount(e,c,y,u.length,Number.isNaN(f)?0:f),_=this.getWishedUnitCount(e,d,w,u.length,Number.isNaN(v)?0:v);a+b+A+4*C+6*_<10||(E-=a,x-=b,N-=A,y-=C,w-=_,R(`Adding ${r.village_name} option ${i.base_id} to request`),t&&(t+="&"),t+="squad_requests%5B"+n+"%5D%5Bvillage_id%5D="+r.village_id+"&squad_requests%5B"+n+"%5D%5Bcandidate_squad%5D%5Bunit_counts%5D%5Bspear%5D="+a+"&squad_requests%5B"+n+"%5D%5Bcandidate_squad%5D%5Bunit_counts%5D%5Bsword%5D="+b+"&squad_requests%5B"+n+"%5D%5Bcandidate_squad%5D%5Bunit_counts%5D%5Baxe%5D="+A+"&squad_requests%5B"+n+"%5D%5Bcandidate_squad%5D%5Bunit_counts%5D%5Blight%5D="+C+"&squad_requests%5B"+n+"%5D%5Bcandidate_squad%5D%5Bunit_counts%5D%5Bheavy%5D="+_+"&squad_requests%5B"+n+"%5D%5Bcandidate_squad%5D%5Bcarry_max%5D=9999999999&squad_requests%5B"+n+"%5D%5Boption_id%5D="+i.base_id+"&squad_requests%5B"+n+"%5D%5Buse_premium%5D=false",n++)}}if(n>0&&t){let e=new URLSearchParams(document.getElementById("menu_row2_village").children[0].href.split("?")[1]).get("village");return R("Sending "+n+" scavenges"),fetch(window.location.origin+"/game.php?village="+e+"&screen=scavenge_api&ajaxaction=send_squads",{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"en-DE,en;q=0.9,de-DE;q=0.8,de;q=0.7,en-GB;q=0.6,en-US;q=0.5","cache-control":"no-cache","content-type":"application/x-www-form-urlencoded; charset=UTF-8",pragma:"no-cache","sec-ch-ua":'"Google Chrome";v="123", "Not:A-Brand";v="8", "Chromium";v="123"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","tribalwars-ajax":"1","x-requested-with":"XMLHttpRequest"},referrer:"https://de224.die-staemme.de/game.php?village="+e+"&screen=place&mode=scavenge_mass",referrerPolicy:"strict-origin-when-cross-origin",body:t+"&h="+L().csrf,method:"POST",mode:"cors",credentials:"include"}).then((e=>{y(1===n?`${n} Raubzug wurde gestartet`:`${n} Raubzüge wurden gestartet`)})).catch((e=>{throw w("Fehler beim senden der Raubzüge"),e}))}{let e;if(0===i.length)e=(new Date).getTime()/1e3+3600;else{i.sort(((e,t)=>e-t));let t=Math.floor(Math.random()*(i.length/25));e=i[t]}N(b.SCAVENGE_NEXT_RUN,1e3*e+""),R(`${this.getName()} nothing to send...`)}}))}getWishedUnitCount(e,t,n,i,a){let r=Math.floor(t/i);return r+=1==e?t%i:0,r+ +a>n&&(r=n-+a),r<0&&(r=0),r}}let K=["main","barracks","stable","garage","church","church_f","watchtower","snob","smith","place","statue","market","wood","stone","iron","farm","storage","hide","wall"],j=["Hauptgebäude","Kaserne","Stall","Werkstatt","Kirche","Kirche","Wachturm","Adelshof","Schmiede","Versammlungsplatz","Statue","Marktplatz","Holzfällerlager","Lehmgrube","Eisenmine","Bauernhof","Speicher","Versteck","Wall"];class F{constructor(e){"string"==typeof e?(this.id=K.indexOf(e),this.name=e):(this.id=e,this.name=K[e]),this.uiName=j[this.id]}getId(){return this.id}getName(){return this.name}getUiName(){return this.uiName}createIcon(e){let t=document.createElement("img");return t.src="https://dsde.innogamescdn.com/asset/234518f7/graphic/buildings/"+this.name+".png",t.setAttribute("data-title",this.uiName),t.className="tooltip-delayed sta-building-icon",e&&UI.ToolTip(t),t}}var J=function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};class H extends F{constructor(e,t,n,i){super(e),this.level=t,this.totalLevel=n.getLevel(),this.buildingTotal=n,this.previous=i}setNext(e){this.next=e}getNext(){return this.next}setPrevious(e){this.previous=e}getPrevious(){return this.previous}getTotalLevel(){return this.totalLevel}getLevel(){return this.level}addLevel(){this.level++}addTotalLevel(e){e===this.id&&(this.totalLevel++,this.buildingTotal.setLevel(this.totalLevel)),this.next&&this.next.addTotalLevel(e),this.updateUI()}removeLevel(){this.level--}removeTotalLevel(e){e===this.id&&(this.totalLevel--,this.buildingTotal.setLevel(this.totalLevel)),this.next&&this.next.removeTotalLevel(e),this.updateUI()}getComp(){return this.comp}updateUI(){this.comp.getElementsByClassName("sta-construction-entry-level")[0].textContent="+"+this.level+" (Stufe "+this.totalLevel+")"}paint(e){e&&e.level&&e.maxLevel&&e.found?e.level>=this.totalLevel?this.comp.style.backgroundColor="rgba(136,245,100,0.53)":e.maxLevel<this.totalLevel?this.comp.style.backgroundColor="rgba(245,100,100,0.53)":this.comp.style.backgroundColor="":this.comp.style.backgroundColor="rgba(161,161,161,0.53)"}create(){let e=document.createElement("div");e.className="sta-construction-entry-row sta-fade-in",this.comp=e;let t=this.createIcon(!1);t.className="sta-construction-entry-icon",e.appendChild(t);let n=document.createElement("div");n.className="sta-construction-entry-name",n.textContent=this.uiName,e.appendChild(n);let i=document.createElement("div");i.className="sta-construction-entry-level",e.appendChild(i),this.updateUI();let a=document.createElement("div");a.className="sta-construction-entry-plus",a.setAttribute("data-title","Stufe erhöhen"),UI.ToolTip(a),e.appendChild(a);let r=e=>{e.preventDefault(),this.addLevel(),this.addTotalLevel(this.id)};a.addEventListener("click",r);let o=document.createElement("div");o.className="sta-construction-entry-minus",o.setAttribute("data-title","Stufe reduzieren"),UI.ToolTip(o),e.appendChild(o);let s=e=>{e.preventDefault(),this.level<=1||(this.removeLevel(),this.removeTotalLevel(this.id))};o.addEventListener("click",s);let l=document.createElement("div");l.className="sta-construction-entry-drag",l.setAttribute("data-title","Feature noch nicht implementiert. Spenden via Paypal könnten die Entwicklung beschleunigen ;)");let c=e=>{e.preventDefault()};o.addEventListener("drag",c);let d=document.createElement("div");d.className="sta-construction-entry-remove",d.setAttribute("data-title","Eintrag löschen"),UI.ToolTip(d),e.appendChild(d);let u=e=>{e.preventDefault(),d.removeEventListener("click",u),o.removeEventListener("click",s),a.removeEventListener("click",r),l.removeEventListener("click",c);for(let e=0;e<this.level;e++)this.removeTotalLevel(this.id);this.fadeOut(this.comp),this.next&&this.next.setPrevious(this.previous),this.previous&&this.previous.setNext(this.next)};return d.addEventListener("click",u),UI.ToolTip(l),e.appendChild(l),e}fadeOut(e){return J(this,void 0,void 0,(function*(){e.classList.remove("sta-fade-in"),e.className+=" sta-fade-out";let t=e.parentElement,n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),a=0;for(let n=0;n<t.children.length&&t.children[n]!==e;n++){a+=t.children[n].getBoundingClientRect().height+2}e.style.position="absolute",e.style.top=a+"px",e.style.left=i.left-n.left+"px",e.style.width=i.width+"px",e.style.height=i.height+"px",e.style.zIndex="17000",yield _(200),e.remove()}))}}class X extends F{constructor(e){super(e),this.level=0}addLevel(e){this.level+=e}setLevel(e){this.level=e,this.levelComp.textContent=e+""}getLevelComp(){return this.levelComp}getLevel(){return this.level}create(){let e=document.createElement("div");e.className="sta-construction-building-upgradeable",e.appendChild(this.createIcon(!0));let t=document.createElement("div");return t.className="sta-construction-building-level-upgradeable",t.textContent=this.getLevel()+"",this.levelComp=t,e.appendChild(t),e}}var Z=function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};class Y extends G{constructor(){var e;super("Konstruktion",[{short:"Aktiviert:",long:"Baut die ausgewählten Dörfer nach Bauplan aus, wenn der Bot läuft",setting:b.CONSTRUCTION_ENABLED,type:"checkbox"},{short:"Bauplan:",long:"Export-Code einer Konstruktions-Vorlage",setting:b.CONSTRUCTION_BUILD_CODE,type:"text"}]);try{this.decodeBuildplan(A(b.CONSTRUCTION_BUILD_CODE)),this.createBody();let t=L();+(null===(e=t.player)||void 0===e?void 0:e.villages)>1&&(t.features.Premium.active&&!t.features.AccountManager.possible?this.createPremium("Konstruktion für mehrere Dörfer mit Premium aktiv"):t.features.AccountManager.possible?this.createPremium("Account Manager kann aktiviert werden. Konstruktion kann nicht genutzt werden!"):this.createPremium("Konstruktion bei mehr als einem Dorf nur mit Premium möglich!")),this.runner=new Q(this)}catch(e){console.error(e)}}decodeBuildplan(e){let t;this.buildings=[],this.firstBuilding=void 0,this.lastBuilding=void 0,this.planName=void 0;try{t=atob(e)}catch(e){return void console.error("Ungültiger Code")}let n,i,a,r={number:X},o=L();for(let e in o.village.buildings){let t=new X(e);r[t.getId()]=t}for(let e=2;e<t.length;e+=2){if(244!=t.charCodeAt(e)&&244!=t.charCodeAt(e+1)||128!=t.charCodeAt(e+1)&&128!=t.charCodeAt(e+4)||128!=t.charCodeAt(e+2)||128!=t.charCodeAt(e+3)||(n?(i=e,244===t.charCodeAt(e+1)&&i++):(n=e+4,244===t.charCodeAt(e+1)&&n++)),n)continue;let o=t.charCodeAt(e),s=r[o],l=t.charCodeAt(e+1);s||(s=new X(o),r[o]=s),s.addLevel(l);let c=new H(o,l,s,a);a&&a.setNext(c),a=c,this.firstBuilding||(this.firstBuilding=a)}if(this.lastBuilding=a,!this.firstBuilding&&!this.lastBuilding){let e=r[0];e.addLevel(1),this.firstBuilding=new H(0,1,e,void 0),this.lastBuilding=this.firstBuilding}for(let e=0;e<20;e++)r[e]&&this.buildings.push(r[e]);this.planName=n&&i?t.substring(n,i).trim():"Default"}encodeBuildplan(e){let t="";t+="??";let n=e;for(;n;)t+=String.fromCharCode(n.getId()),t+=String.fromCharCode(n.getLevel()),n=n.getNext();t+=String.fromCharCode(244),t+=String.fromCharCode(128),t+=String.fromCharCode(128),t+=String.fromCharCode(128),t+=this.planName,t+=String.fromCharCode(244),t+=String.fromCharCode(128),t+=String.fromCharCode(128),t+=String.fromCharCode(128);let i=btoa(t.toString());N(b.CONSTRUCTION_BUILD_CODE,i);let a=this.component.getElementsByClassName("sta-setting-input-sta-construction-build-code")[0];a&&(a.value=i)}createBody(){let e=this.createHeader(this.planName);e.id="sta-buildplan-header",this.component.appendChild(e),this.component.appendChild(this.createBuildplan())}createBuildplan(){let e=document.createElement("div");return e.className="sta-construction-menu-buildplan",this.plan=this.createPlan(),e.appendChild(this.createBuildingSelector()),e.appendChild(this.plan),this.component.getElementsByClassName("sta-setting-input-sta-construction-build-code")[0].addEventListener("change",(t=>{t.preventDefault(),this.plan.remove(),this.decodeBuildplan(A(b.CONSTRUCTION_BUILD_CODE)),this.plan=this.createPlan(),e.insertBefore(this.plan,e.children[0]),document.getElementById("sta-buildplan-header").textContent=this.planName})),e}createPlan(){var e,t;let n=document.createElement("div");n.className="sta-construction-plan";let i,a=document.createElement("div");a.className="sta-construction-plan-inverter",a.textContent="Liste umdrehen",n.appendChild(a),n.appendChild(this.createPlanHeader());try{i=JSON.parse(A(b.VILLAGE_DATA))}catch(e){R("Could not load saved village data")}i||(i={});let r=document.createElement("div");r.className="sta-construction-entries","true"===A(b.CONSTRUCTION_PLAN_INVERTED)&&r.classList.add("sta-construction-plan-inverted"),n.appendChild(r);let o=this.firstBuilding;for(;o;)this.appendEntryToPlan(r,o,null===(t=null===(e=i[L().village.id])||void 0===e?void 0:e.buildings)||void 0===t?void 0:t[o.getName()]),o=o.getNext();return a.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),r.classList.contains("sta-construction-plan-inverted")?(N(b.CONSTRUCTION_PLAN_INVERTED,"false"),r.classList.remove("sta-construction-plan-inverted")):(N(b.CONSTRUCTION_PLAN_INVERTED,"true"),r.classList.add("sta-construction-plan-inverted"))})),n}appendEntryToPlan(e,t,n){e.appendChild(t.create()),t.paint(n),t.getComp().getElementsByClassName("sta-construction-entry-remove")[0].addEventListener("click",(e=>{e.preventDefault(),this.lastBuilding===t&&(this.lastBuilding=t.getPrevious()),this.firstBuilding===t&&(this.firstBuilding=t.getNext())}));let i=e=>{e.preventDefault(),e.stopPropagation(),this.encodeBuildplan(this.firstBuilding)};t.getComp().getElementsByClassName("sta-construction-entry-plus")[0].addEventListener("click",i),t.getComp().getElementsByClassName("sta-construction-entry-minus")[0].addEventListener("click",i),t.getComp().getElementsByClassName("sta-construction-entry-drag")[0].addEventListener("click",i),t.getComp().getElementsByClassName("sta-construction-entry-remove")[0].addEventListener("click",i)}createPlanHeader(){let e=document.createElement("div");e.className="sta-total-level";for(let t of this.buildings)e.appendChild(t.create()),t.getLevelComp().addEventListener("click",(e=>{var n,i,a,r;e.preventDefault(),e.stopPropagation();let o,s=new H(t.getId(),1,t,this.lastBuilding);this.lastBuilding&&this.lastBuilding.setNext(s),this.lastBuilding=s,this.firstBuilding||(this.firstBuilding=s);try{o=JSON.parse(A(b.VILLAGE_DATA))}catch(e){R("Could not load saved village data")}o||(o={}),this.appendEntryToPlan(this.plan.getElementsByClassName("sta-construction-entries")[0],s,null===(i=null===(n=o[L().village.id])||void 0===n?void 0:n.buildings)||void 0===i?void 0:i[t.getName()]),s.addTotalLevel(s.getId()),s.paint(null===(r=null===(a=o[L().village.id])||void 0===a?void 0:a.buildings)||void 0===r?void 0:r[t.getName()]),this.encodeBuildplan(this.firstBuilding)}));return e}onLoad(e,t){this.runner.onLoad(e,t)}preRun(){return Z(this,void 0,void 0,(function*(){let e=L();return e.features.AccountManager.possible?(w("Account Manager kann aktiviert werden. Konstruktion deaktiviert sich selbst!"),this.invertEnabled(),!1):+e.player.villages>1&&!e.features.Premium.active?(w("Konstruktion bei mehr als einem Dorf nur mit Premium möglich! Konstruktion deaktiviert sich selbst!"),void this.invertEnabled()):this.runner.preRun(this.firstBuilding)}))}run(){return Z(this,void 0,void 0,(function*(){return this.runner.run(this.firstBuilding)}))}postRun(){this.runner.postRun()}}class Q extends q{constructor(e){super(),this.config=e}onLoad(e,t){let n=new URLSearchParams(t.search);if(n.has("screen")&&"overview_villages"===n.get("screen")&&n.has("mode")&&"buildings"===n.get("mode")){let t=this.getVillageDataFromMassUpgrade(e.getElementById("villages"));t&&N(b.VILLAGE_DATA,JSON.stringify(t))}if(n.has("screen")&&"main"===n.get("screen")){this.readSingleVillageData(e,L().village.id)}}getVillageDataFromMassUpgrade(e){let t;try{t=JSON.parse(A(b.VILLAGE_DATA))}catch(e){R("Exception reading village Data"),t={}}for(let n of e.children){let e=+n.id.substring(2);t[e]||(t[e]={coord:"",id:e,name:"",resources:{iron:0,stone:0,wood:0},buildings:{},queue:0}),t[e].buildings||(t[e].buildings={});for(let n of Object.keys(t[e].buildings))t[e].buildings[n].found=!1,t[e].buildings[n].canBuild=!1;let i=n.getElementsByClassName("queue_icon"),a={};for(let e of i){let t=e.children[0].src;t=t.substring(t.lastIndexOf("/")+1,t.lastIndexOf(".")),a[t]=a[t]?a[t]+1:1}t[e].queue=i.length;for(let i of n.getElementsByClassName("upgrade_building")){let n;for(let e of i.classList)if(e.startsWith("b_")){n=e.substring(2);break}let r=i.children.length>0?i.children[0]:void 0;r&&r.classList.contains("hidden")&&(r=void 0);let o=r?+r.textContent:+i.textContent;t[e].buildings[n]=Object.assign(Object.assign({},t[e].buildings[n]),{found:!0,error:void 0,forecast:void 0,level:o,canBuild:!!r,nextLevel:1+o+(a[n]?a[n]:0)})}}return t}readSingleVillageData(e,t){let n,i;try{n=JSON.parse(A(b.VILLAGE_DATA))}catch(e){R("Could not load saved village data"),n={}}n[t]||(n[t]={coord:"string",name:"string",id:t,resources:{wood:0,stone:0,iron:0},buildings:{},queue:0}),n[t].buildings||(n[t].buildings={});try{let t=$(e).find('script:contains("BuildingMain.buildings")'),n=t[t.length-1].innerHTML;i=JSON.parse(n.substring(30,n.length-2))}catch(e){R("Could not find BuildingMain.buildings")}if(!i)return n[t].buildings;for(let e in L().village.buildings)n[t].buildings[e]?n[t].buildings[e].found=!1:n[t].buildings[e]={canBuild:!1,error:"Doesn't exist",forecast:void 0,iron:0,level:0,maxLevel:0,nextLevel:0,population:0,require:void 0,stone:0,wood:0,found:!1};for(let e in L().village.buildings){let a=i[e];if(!a)continue;let r=n[t].buildings[e];r.found=!0,r.level=a.level_next-1,r.nextLevel=a.level_next,r.maxLevel=a.max_level,r.population=a.pop,r.wood=a.wood,r.stone=a.stone,r.iron=a.iron,r.require=a.require,r.forecast=a.forecast,r.error=a.error,r.canBuild=a.can_build,n[t]||(n[t]={coord:"string",name:"string",id:t,resources:{wood:0,stone:0,iron:0},buildings:{},queue:0}),n[t].buildings||(n[t].buildings={}),n[t].buildings[e]=r}return N(b.VILLAGE_DATA,JSON.stringify(n)),n[t].buildings}preRun(e){return Z(this,void 0,void 0,(function*(){let e=+A(b.CONSTRUCTION_NEXT_RUN);return!(Date.now()<e)||(R(`${this.config.getName()} waiting `+I(e/1e3)),!1)}))}run(e){return Z(this,void 0,void 0,(function*(){let t=L();return t.features.Premium.active&&this.config.isPremium()?this.runPremium(e):this.runFree(e,t.village.id)}))}postRun(){N(b.REWARD_NEXT_RUN,"0")}runPremium(e){return Z(this,void 0,void 0,(function*(){let t=L();return k(`game.php?village=${t.village.id}&screen=overview_villages&mode=buildings`).then((n=>{let i=this.getVillageDataFromMassUpgrade($(n).find("#villages")[0]);return i&&N(b.VILLAGE_DATA,JSON.stringify(i)),k(`game.php?village=${t.village.id}&screen=main&ajax=get_all_possible_building_upgrades&destroy=0&page_start=0&page_size=${t.player.villages}&order=&dir=asc&group_id=0`).then((t=>{let n=this.getVillageDataWithUpdateLinks(t),i=!1;for(let t of Object.keys(n)){let a=n[+t];if(!this.config.isVillageEnabled(t)){R(`${a.name} disabled for ${this.config.getName()}`);continue}if(a.queue>=5){R(`${a.name} queue full for ${this.config.getName()}`);continue}let r=this.findNextEntry(a.buildings,e);r?(i=!0,D("/game.php?village="+t+"&screen=main&ajaxaction=upgrade_building&type=main","id="+r.getName()+"&force=1&destroy=0&source="+t+"&h=+"+L().csrf).then((e=>{y(`${r.getUiName()} zur Bauschleife in ${a.name} hinzugefügt`),this.setNewRewardRun(e.date_complete)}))):R(`In ${a.name} nothing todo`)}i||N(b.CONSTRUCTION_NEXT_RUN,Date.now()+60*(45*Math.random()+15)*1e3+"")}))}))}))}getVillageDataWithUpdateLinks(e){let t;try{t=JSON.parse(A(b.VILLAGE_DATA))}catch(e){R("Exception reading village Data"),t={}}for(let n of Object.keys(e.villages)){let i=e.villages[n],a=+n;t[a]||(t[a]={coord:"",id:a,name:"",resources:{iron:0,stone:0,wood:0},buildings:{},queue:0}),t[a].buildings||(t[a].buildings={});for(let e of Object.keys(i.buildings))t[a].buildings[e]?(t[a].buildings[e].canBuild=!0,t[a].buildings[e].error=void 0,t[a].buildings[e].forecast=void 0):t[a].buildings[e]={error:void 0,forecast:void 0,found:!0,iron:0,level:0,maxLevel:0,nextLevel:0,population:0,require:{},stone:0,wood:0,canBuild:!0}}return t}canFinishEarly(e){try{let t=+$(e).find(".btn-instant-free")[0].getAttribute("data-available-from");if(Date.now()/1e3+180>t)return!0}catch(e){R("Could not find finish early button")}return!1}finishEarly(e){try{if(!this.canFinishEarly(e))return;let t=$(e).find(".btn-instant-free")[0].getAttribute("onclick"),n=t.indexOf("("),i=t.indexOf(")");t=t.substring(n+1,i);let a=t.split(","),r=a[1].split("'");BuildingMain.change_order(a[0],r[1],a[2])}catch(e){R("Could not finish early")}}runFree(e,t){return Z(this,void 0,void 0,(function*(){return k(`game.php?screen=main&village=${t}`).then((n=>{let i=new URLSearchParams(window.location.search);if(i.has("screen")&&"main"===i.get("screen")&&this.finishEarly(n),this.isQueueFull(n))return;let a=this.readSingleVillageData(n,t),r=this.findNextEntry(a,e);return r?(R("Upgrading "+r.getName()),r.getComp().style.backgroundColor="rgba(77,222,255,0.53)",D("/game.php?village="+t+"&screen=main&ajaxaction=upgrade_building&type=main","id="+r.getName()+"&force=1&destroy=0&source="+t+"&h=+"+L().csrf).then((e=>{y(`${r.getUiName()} zur Bauschleife hinzugefügt`),this.setNewRewardRun(e.date_complete)}))):(R("Nothing todo, sleep one hour for Construction"),y("Konstruktion beendet. Bitte das Feature ausschalten oder den Bauplan erweitern."),void N(b.CONSTRUCTION_NEXT_RUN,Date.now()+36e5+""))}))}))}setNewRewardRun(e){try{let t=Date.now()+e;+A(b.REWARD_NEXT_RUN)>t&&N(b.REWARD_NEXT_RUN,t+"")}catch(e){R("Could not update next reward run")}}isQueueFull(e){try{let t=$(e).find("#buildqueue")[0],n=function(e){try{let t=+JSON.parse($(e).find(".order-progress")[0].getAttribute("data-progress")).slot_end;return $(document).find(".btn-instant")[0]?t-180:t}catch(e){R("Could not find when next building finishes")}return 0}(e),i=t.children.length-2;if(t&&t.children&&i>=(L().features.Premium.active?5:2))return R("Queue full. Next building finishes in "+I(n)),N(b.CONSTRUCTION_NEXT_RUN,1e3*(n+5)+""),!0}catch(e){R("Could not read queue")}return!1}findNextEntry(e,t){let n=t;for(;n;){let t=e[n.getName()];if(t)if(t.nextLevel>n.getTotalLevel())n=n.getNext();else if(t.maxLevel<t.nextLevel)n=n.getNext();else{if(t.found)return t.forecast?(R("Upgrading "+n.getName()+" to "+t.nextLevel+" in "+I(t.forecast.when)),void N(b.CONSTRUCTION_NEXT_RUN,1e3*(+t.forecast.when+5)+"")):t.error?void R("Error: '"+t.error+"' for "+n.getName()):t.canBuild?n:void 0;n=n.getNext()}else R(n.getName()+" not found - Skip"),n=n.getNext()}}}var ee=function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};class te extends G{constructor(){super("Belohnung",[{short:"Aktiviert:",long:"Löst Belohnungen für den Ausbau von Gebäuden ein",setting:b.REWARD_ENABLED,type:"checkbox"}]),this.runner=new ne}onLoad(e,t){}preRun(){return this.runner.preRun()}run(){return this.runner.run()}postRun(){return this.runner.postRun()}}class ne extends q{onLoad(e,t){}preRun(){return ee(this,void 0,void 0,(function*(){var e,t;if((null!==(t=this.readRewardData(null===(e=$(document).find('script:contains("RewardSystem.setRewards(")')[0])||void 0===e?void 0:e.textContent))&&void 0!==t?t:[]).length>1)return!0;let n=+A(b.REWARD_NEXT_RUN);return!(Date.now()<n)||(R(`Reward waiting ${I(n/1e3)}`),!1)}))}readRewardData(e){try{if(!e)return[];let t=e.indexOf("RewardSystem.setRewards("),n=(e=e.substring(t+24)).indexOf("]");e=e.substring(0,n+1);let i=JSON.parse(e);return i.length>0&&N(b.REWARD_NEXT_RUN,"0"),i}catch(e){return R("Error reading reward data"),[]}}run(){return ee(this,void 0,void 0,(function*(){let e=L();return S(`game.php?village=${e.village.id}&screen=new_quests&ajax=quest_popup&tab=main-tab&quest=0`).then((t=>ee(this,void 0,void 0,(function*(){let n=JSON.parse(t).response.dialog,i=this.readRewardData($(n)[2].textContent),a=[];for(let t of i)yield _(250),a.push(S(`game.php?village=${e.village.id}&screen=new_quests&ajax=claim_reward`,`reward_id=${t.id}&h=${e.csrf}`,"POST"));return 1===i.length?y(`${i.length} Belohnung abgeholt`):i.length>1&&y(`${i.length} Belohnungen abgeholt`),Promise.all(a)}))))}))}postRun(){N(b.REWARD_NEXT_RUN,Date.now()+36e5+""),N(b.CONSTRUCTION_NEXT_RUN,"0")}}var ie=n(772),ae={};ae.styleTagTransform=p(),ae.setAttributes=c(),ae.insert=s().bind(null,"head"),ae.domAPI=r(),ae.insertStyleElement=u();t()(ie.A,ae);ie.A&&ie.A.locals&&ie.A.locals;var re=function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};class oe extends G{constructor(){super("Berichte",[{short:"Info:",long:"Fügt den Button 'Verarbeiten' oberhalb der Berichte hinzu, damit können alle Berichte anhang folgender Einstellungen verarbeitet werden",setting:b.REPORT_ENABLED,type:"checkbox"},{short:"Archivieren:",long:"Ordner in den die Berichte verschoben werden sollen",setting:b.REPORT_ARCHIVE,type:"text"},{short:"Datenbank Benutzer:",long:"Benutzer für www.diestaemmedb.de",setting:b.REPORT_DB_USER,type:"text"},{short:"Datenbank Passwort:",long:"Passwort für www.diestaemmedb.de",setting:b.REPORT_DB_PASSWORD,type:"password"}]);try{{let e=this.component.children[1].children[1].children[0];return e.disabled=!0,e.setAttribute("data-title","Noch nicht implementiert"),void C(e)}}catch(e){console.error(e)}}isReportPage(){let e=new URLSearchParams(window.location.search);return e.has("screen")&&"report"===e.get("screen")}createProcessButton(){let e=document.createElement("button");e.textContent="Verarbeiten",e.className="btn sta-report-process",e.addEventListener("click",(e=>re(this,void 0,void 0,(function*(){e.stopPropagation(),e.preventDefault(),yield this.run(),this.postRun()}))));let t=document.getElementsByClassName("report-preview")[0].parentElement;t.insertBefore(e,t.children[0])}onLoad(e,t){}preRun(){return re(this,void 0,void 0,(function*(){return!1}))}run(){return re(this,void 0,void 0,(function*(){let e=A(b.REPORT_DB_USER),t=A(b.REPORT_DB_USER);e&&t?this.selectAllAndPublish():w("Benutzer oder Passwort nicht gesetzt.")}))}postRun(){}selectAllAndPublish(){return re(this,void 0,void 0,(function*(){yield _(100),document.getElementById("select_all").click(),yield _(100),document.getElementsByName("forward")[0].click();let e=new URLSearchParams(window.location.search);e.has("screen")&&"report"===e.get("screen")&&e.has("mode")&&"process_reports"===e.get("mode")&&e.has("refmode")&&"all"===e.get("refmode")&&document.getElementsByClassName("btn")[0].click()}))}}var se=function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};class le{constructor(){this.features=[new oe,new Y,new te,new z],this.checkVillageCount().then((e=>{try{let e=this.createMenuButton();this.addMenuEntries(e),this.popup=new M(this.features);for(let e of this.features)e.onLoad(document,window.location);let t="true"===A(b.RUNNING);this.updateIcon(t),e.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation();let t=!("true"===A(b.RUNNING));N(b.RUNNING,t+""),this.updateIcon(t)}))}catch(e){R("Exception during Menu.constructor"),R(e)}}))}checkVillageCount(){return se(this,void 0,void 0,(function*(){let e;try{e=JSON.parse(A(b.VILLAGE_DATA))}catch(e){return void R("Error checking village count")}if(Object.keys(e).length!==+L().player.villages)return D(`/game.php?village=${L().village.id}&screen=groups&ajax=load_villages_from_group`,"group_id=0&h="+L().csrf).then((t=>{let n=[],i=$(t.html).find("#group_table")[0].children[0];for(let t of i.children){let i=t.children[0].children[0],a=i.getAttribute("data-village-id"),r=i.textContent,o=t.children[1].textContent.trim();n.push(a),e[a]||(e[a]={coord:"string",name:"string",id:1,resources:{wood:0,stone:0,iron:0},buildings:{},queue:0}),e[a].name=r,e[a].id=a,e[a].coord=o}for(let t of Object.keys(e))n.includes(+t)||delete e[+t];N(b.VILLAGE_DATA,JSON.stringify(e)),R("Updated village list")}));R("Village count correct")}))}getFeatures(){return this.features}updateIcon(e){let t=document.getElementById("menuIcon");t.className=e?"icon header new_post":"icon header no_new_post"}createMenuButton(){let e=document.createElement("td");e.id="menuButton",e.className="menu-item";let t=document.getElementById("menu_row");t&&t.insertBefore(e,t.children[t.children.length-1]);let n=document.getElementById("mobileTouch");n&&n.insertBefore(e,n.children[n.children.length-1]);let i=document.createElement("span");i.id="menuIcon",i.className="icon header no_new_post";let a=document.createElement("a");return a.appendChild(i),a.id="iconContainer",a.innerHTML+=" Bot",e.appendChild(a),e}addMenuEntries(e){let t=document.createElement("table");e.appendChild(t),t.className="menu_column sta-menu-column";let n=document.createElement("tbody");t.appendChild(n);let i=!0;for(let e of this.features){let t,a;i?(i=!1,t="-first-child",a="sta-leftUiThingyFirstChild"):(t="",a="sta-leftUiThingy"),this.addItem(n,e,a,t)}this.addMenuBottom(n)}addItem(e,t,n,i){let a=document.createElement("tr");e.appendChild(a);let r=document.createElement("td");a.appendChild(r),r.className="menu-column-item sta-menu-column-item";let o=document.createElement("div");r.appendChild(o),o.className=n;let s=document.createElement("input");s.type="checkbox",s.className="sta-menu-item-checkbox"+i,s.checked="true"===A(t.getEnabledSetting()),s.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),t.invertEnabled()})),t.subscribe((e=>{s.checked=e}));let l=document.createElement("div");l.innerText=t.getName(),l.className="sta-menu-column-item-text"+i;let c=document.createElement("div");c.className="sta-menu-item-container",c.appendChild(s),c.appendChild(l),r.appendChild(c);let d=this;a.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),d.popup.show(t.getName())}))}addMenuBottom(e){let t=document.createElement("tr");e.appendChild(t);let n=document.createElement("td");t.appendChild(n),n.className="bottom";let i=document.createElement("div");i.className="corner sta-corner",n.appendChild(i);let a=document.createElement("div");a.className="decoration",n.appendChild(a)}}var ce=function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};class de{constructor(e){setTimeout((()=>this.check(e)),5e3)}check(e){return ce(this,void 0,void 0,(function*(){for(;;){yield _(1e3*Math.floor(60*Math.random()));for(let t of e.getFeatures())if(yield _(5e3),t.isError())R("Skipping "+t.getName()+" because of previous error");else try{(yield this.run(t))&&R(t.getName()+" ran")}catch(e){R(e),w(`Fehler bei ${t.getName()}. Funktion wird deaktiviert bis die Seite neu geladen wird. Bei anhalten des Fehlers bitte Entwickler kontaktieren.`),t.setError(!0)}}}))}run(e){return ce(this,void 0,void 0,(function*(){if("true"!==A(b.RUNNING)||"true"!==A(e.getEnabledSetting()))return!1;try{if(!(yield e.preRun()))return!1}catch(t){throw R(e.getName()+" - Exception during preRun"),t}try{yield e.run()}catch(t){throw R(e.getName()+" - Exception during run"),t}try{e.postRun()}catch(t){R(e.getName()+" - Exception during postRun")}return!0}))}}var ue=n(595),he={};he.styleTagTransform=p(),he.setAttributes=c(),he.insert=s().bind(null,"head"),he.domAPI=r(),he.insertStyleElement=u();t()(ue.A,he);ue.A&&ue.A.locals&&ue.A.locals;class pe{constructor(){try{this.autoLogin(),this.createCheckboxes()}catch(e){R("Exception during Login.constructor"),R(e)}}createCheckboxes(){let e=document.getElementsByClassName("world-select");for(let t=0;t<e.length;t++){let n=e[t];if("Aktuelle Welten"!==n.parentElement.children[0].textContent)continue;n.classList.add("sta-login-item");let i=document.createElement("input");i.type="checkbox",n.href===A(b.AUTO_LOGIN_WORLD)&&(i.checked=!0),i.addEventListener("change",(e=>{var t;i.checked?(N(b.AUTO_LOGIN_WORLD,n.href),this.autoLogin()):(t=b.AUTO_LOGIN_WORLD,localStorage.removeItem(t))})),n.insertBefore(i,n.children[0])}let t=e[0].parentElement;t.classList.add("sta-login-parent"),t.children[0].classList.add("sta-login-header")}login(){let e=A(b.AUTO_LOGIN_WORLD);e&&(window.location.href=e)}autoLogin(){setTimeout((()=>this.login()),1e3*(5*Math.random()+5))}}var ge=function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};function me(){return ge(this,void 0,void 0,(function*(){if(window.location.origin.includes("www.die-staemme.de"))return void new pe;let e;if("0"!==L().player.sitter)return void console.log("Sitter mode detected - abort!");try{e=function(e){let t,n;try{let n=$(e).find('script:contains("TribalWars.updateGameData")')[0].innerHTML,i=n.indexOf("TribalWars.updateGameData(")+26,a=n.indexOf(");");t=JSON.parse(n.substring(i,a))}catch(e){R("Could not find TribalWars.updateGameData")}if(!t)throw"IDK anymore";try{n=JSON.parse(A(b.VILLAGE_DATA))}catch(e){R("Error during reading Village Data, create new"),n={}}let i=n[t.village.id];return i||(i={resources:{}}),i.resources||(i.resources={}),i.resources.wood=t.village.wood,i.resources.stone=t.village.stone,i.resources.iron=t.village.iron,i.name=t.village.name,i.id=t.village.id,i.storageMax=t.village.storage_max,n[i.id]=i,N(b.VILLAGE_DATA,JSON.stringify(n)),t}(document)}catch(e){R("Error reading game data")}let t=new le;new de(t)}))}})(),staemme=i})();