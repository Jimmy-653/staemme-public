var staemme;(()=>{"use strict";var e={595:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(601),o=n.n(r),i=n(314),a=n.n(i)()(o());a.push([e.id,".sta-login-header {\n    width: 100%;\n}\n\n.sta-login-parent {\n    display: flex;\n    flex-wrap: wrap;\n}\n\n.sta-login-item {\n    display: flex;\n    width: fit-content;\n}\n",""]);const s=a},407:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(601),o=n.n(r),i=n(314),a=n.n(i)()(o());a.push([e.id,"#menuButton {\n    cursor: pointer;\n}\n\n.sta-menu-item-checkbox-first-child {\n    margin: 3px 0px 0px;\n}\n\n.sta-menu-item-checkbox {\n    margin: 1px 0px 0px;\n}\n\n.sta-menu-item-container {\n    display: flex;\n    gap: 3px;\n    align-items: center;\n    left: -5px;\n    position: relative;\n}\n\n.sta-leftUiThingyFirstChild {\n    background: transparent url(https://dsde.innogamescdn.com/asset/c045337f/graphic/index/dropdown-topleft.png) scroll left top no-repeat;\n    height: 21px;\n    width: 20px;\n    left: -5px;\n    position: relative;\n}\n\n.sta-leftUiThingy {\n    background: transparent url(https://dsde.innogamescdn.com/asset/c045337f/graphic/index/dropdown-itemleft.png) scroll left top no-repeat;\n    height: 21px;\n    width: 20px;\n    left: -5px;\n    position: relative;\n}\n\n.sta-menu-column-item-text-first-child:hover, .sta-menu-column-item-text:hover, #iconContainer:hover {\n    color: #f0d49a;\n}\n\n.sta-menu-column-item-text-first-child {\n    padding: 5px 12px 3px 6px;\n    left: -5px;\n    position: relative;\n}\n\n.sta-menu-column-item-text {\n    padding: 4px 12px 3px 6px;\n    left: -5px;\n    position: relative;\n}\n\n.sta-menu-column-item {\n    display: flex !important;\n    flex-direction: row;\n}\n\n.sta-corner {\n    left: -5px !important;\n}\n\n.sta-menu-column {\n    margin-left: 4px !important;\n    border-spacing: 0;\n}\n\n.sta-construction-building-upgradeable {\n    display: flex;\n    flex-direction: column;\n    gap: 2px;\n}\n\n.sta-construction-building-level-upgradeable {\n    background-color: #f0e2be;\n    font-weight: 700;\n    color: #603000;\n    cursor: pointer;\n    width: 22px;\n    height: 18px;\n    padding: 2px;\n    text-align: center;\n    align-content: center;\n}\n\n.sta-building-icon {\n    background-image: url(https://dsde.innogamescdn.com/asset/234518f7/graphic/screen/tableheader_bg3.png);\n    background-size: contain;\n    width: 18px;\n    height: 18px;\n    padding: 4px;\n}\n\n.sta-total-level {\n    display: flex;\n    gap: 2px;\n    width: fit-content;\n    flex-grow: 0;\n}\n\n.sta-construction-menu-buildplan {\n    display: flex;\n    flex-direction: row;\n    gap: 4px;\n}\n",""]);const s=a},718:(e,t,n)=>{n.d(t,{A:()=>f});var r=n(601),o=n.n(r),i=n(314),a=n.n(i),s=n(417),c=n.n(s),u=new URL(n(535),n.b),l=new URL(n(377),n.b),d=a()(o()),p=c()(u),h=c()(l);d.push([e.id,`.sta-container {\n    background: url(https://dsde.innogamescdn.com/asset/234518f7/graphic/index/grey-fade.png);\n    height: 100%;\n}\n\n.sta-popup {\n    transition-duration: 0.5s;\n    z-index: 15000;\n    border-radius: 16px;\n    overflow: auto;\n    padding: 10px;\n    background-color: rgb(227, 213, 179);\n    background-image: url(https://dsde.innogamescdn.com/asset/234518f7/graphic/index/main_bg.jpg);\n}\n\n.sta-nav-item {\n    color: #603000;\n    cursor: pointer;\n    width: -webkit-fill-available;\n    font-weight: 700;\n    padding: 2px 3px;\n    background-color: rgb(244, 228, 188);\n}\n\n.sta-nav-item.sta-nav-item-selected {\n    background-color: rgb(250, 220, 155);\n    color: #803000;\n}\n\n.sta-logs {\n    font-weight: 700;\n    color: #603000;\n    cursor: pointer;\n}\n\n.sta-popup-header-label {\n}\n\n.sta-popup-description {\n    flex-grow: 1;\n    flex-shrink: 1;\n    padding-left: 50px;\n    padding-right: 50px;\n    max-width: 500px;\n}\n\n.sta-logs:hover {\n    color: #e01f0f;\n}\n\n.sta-popup-header-container {\n    display: flex;\n    flex-direction: row;\n    flex-wrap: nowrap;\n    gap: 4px;\n    align-content: center;\n    margin-bottom: 25px;\n}\n\n.sta-construction-building-level-upgradeable:hover, .sta-nav-item:hover {\n    color: #e01f0f;\n}\n\n.sta-popup-content {\n    gap: 10px;\n    display: flex;\n}\n\n.sta-menu-component {\n    display: flex;\n    flex-direction: column;\n    gap: 2px;\n    position: relative;\n}\n\n.sta-labelled-input {\n    display: flex;\n    background-color: rgb(244, 228, 188);\n    padding: 2px 3px;\n    gap: 2px;\n    flex-grow: 1;\n    max-width: 500px;\n}\n\n.sta-input-label {\n    align-content: center;\n}\n\n.sta-numeric-input {\n    width: 25pt;\n}\n\n.clickable {\n    cursor: pointer;\n}\n\n.sta-menu-header {\n    font-weight: 700;\n    background-image: url(https://dsde.innogamescdn.com/asset/234518f7/graphic/screen/tableheader_bg3.png);\n    padding: 2px 3px;\n}\n\n.sta-menu-item-row {\n    display: flex;\n    gap: 2px;\n}\n\n.sta-menu-setting-label {\n    background-color: rgb(244, 228, 188);\n    padding: 2px 3px;\n    align-content: center;\n    min-width: 135px;\n}\n\n.sta-nav {\n    display: flex;\n    flex-direction: column;\n    height: fit-content;\n    width: fit-content;\n    gap: 2px;\n}\n\n.sta-fade-in {\n    animation: fadein 0.5s linear;\n    position: relative;\n}\n\n.sta-fade-out {\n    animation: fadeout 0.3s linear;\n    position: relative;\n}\n\n.sta-info {\n    background: url('https://dsde.innogamescdn.com/asset/234518f7/graphic/questionmark.png') no-repeat center;\n    background-size: 17px;\n    width: 17px;\n    height: 17px;\n    margin-top: 3px;\n    flex-shrink: 0;\n}\n\n@-webkit-keyframes fadein {\n    0% {\n        opacity: 0;\n        z-index: -1;\n        top: 50px;\n    }\n    100% {\n        opacity: 1;\n        z-index: auto;\n        top: 0px;\n    }\n}\n\n@-webkit-keyframes fadeout {\n    0% {\n        opacity: 1;\n        margin-left: 0px;\n    }\n    100% {\n        opacity: 0;\n        margin-left: -70px;\n    }\n}\n\n.sta-feature-header-premiun-icon {\n    width: 15px;\n    height: 15px;\n    margin-top: 2px;\n}\n\n.sta-feature-header-premium {\n    background-image: url(https://dsde.innogamescdn.com/asset/234518f7/graphic/screen/tableheader_bg3.png);\n    padding: 0px 3px;\n    display: flex;\n    flex-direction: row;\n    gap: 2px;\n}\n\n.sta-construction-entries {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    gap: 2px;\n}\n\n.sta-construction-plan {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    gap: 2px;\n}\n\n.sta-construction-plan-inverted {\n    flex-direction: column-reverse !important;\n}\n\n.sta-construction-plan-inverter {\n    font-weight: 700;\n    color: #603000;\n    cursor: pointer;\n}\n\n.sta-construction-plan-inverter:hover {\n    color: #e01f0f;\n}\n\n.sta-construction-entry-row {\n    display: flex;\n    flex-direction: row;\n    gap: 2px;\n    align-content: center;\n    background-color: rgb(244, 228, 188);\n    align-items: center;\n}\n\n.sta-construction-entry-icon {\n    width: 18px;\n    height: 18px;\n    padding: 2px 4px;\n}\n\n.sta-construction-entry-name {\n    font-weight: 700;\n    color: #603000;\n}\n\n.sta-construction-entry-level {\n    flex-grow: 1;\n}\n\n.sta-construction-entry-plus {\n    background: url(${p}) center no-repeat;\n    background-size: contain;\n    width: 14px;\n    height: 14px;\n    margin: 4px;\n    cursor: pointer;\n}\n\n.sta-construction-entry-minus {\n    background: url(${h}) center no-repeat;\n    background-size: contain;\n    width: 14px;\n    height: 14px;\n    margin: 4px;\n    cursor: pointer;\n}\n\n.sta-construction-entry-remove {\n    background: url(https://dsde.innogamescdn.com/asset/234518f7/graphic/delete.png) center no-repeat;\n    width: 22px;\n    height: 22px;\n    cursor: pointer;\n}\n\n.sta-construction-entry-drag {\n    background: url(https://dsde.innogamescdn.com/asset/234518f7/graphic/sorthandle.png) center no-repeat;\n    width: 22px;\n    height: 22px;\n    cursor: pointer;\n}\n`,""]);const f=d},772:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(601),o=n.n(r),i=n(314),a=n.n(i)()(o());a.push([e.id,'.sta-report-process {\n    background: url("https://dsde.innogamescdn.com/asset/62e187d5/graphic/btn/buttons.png") no-repeat 3px -248px, linear-gradient(to bottom, #947a62 0%,#7b5c3d 22%,#6c4824 30%,#6c4824 100%);\n    padding-left: 25px;\n}\n\n.sta-report-process:hover {\n    background: url("https://dsde.innogamescdn.com/asset/62e187d5/graphic/btn/buttons.png") no-repeat 3px -248px, linear-gradient(to bottom, #b69471 0%,#9f764d 22%,#8f6133 30%,#6c4d2d 100%);\n    padding-left: 25px;\n}\n',""]);const s=a},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var u=0;u<e.length;u++){var l=[].concat(e[u]);r&&a[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),t.push(l))}},t}},417:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},a=[],s=0;s<e.length;s++){var c=e[s],u=r.base?c[0]+r.base:c[0],l=i[u]||0,d="".concat(u," ").concat(l);i[u]=l+1;var p=n(d),h={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)t[p].references++,t[p].updater(h);else{var f=o(h,r);r.byIndex=s,t.splice(s,0,{identifier:d,updater:f,references:1})}a.push(d)}return a}function o(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=n(i[a]);t[s].references--}for(var c=r(e,o),u=0;u<i.length;u++){var l=n(i[u]);0===t[l].references&&(t[l].updater(),t.splice(l,1))}i=c}}},659:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},535:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAilJREFUSEvtlT9oU1EUxn/nviQNNK1/QG3VQpGGahNbMUIpieIiCCI4ieDk5KRgFyeliuBScHNxcNBBKm4OpYODWIpgUayplRQsIm4qrdWa5L179FFLn4nmtU0n8Y7nnvN995x7zvmEsDOA6TyVbYkoZ0U5pqgBeWhcuTHR/eRzWLiEOXQUepvjnnNOrVwL+M4Dt/Jdo/1h8aEEeyYPthq1Qwi5CrC3+VejSU7i1SIJJeguHN7pld1HoMkKoJn4t+/7xg+Mz9ZF0POmb0fZM8MC6f8Efyxl/SUawHSc7k1Ey7HGaNRxxBY1yGSt02LRuyi7f3uB6nsT0SMGvgTtZdc4tuQZN6GfppNP56RzKrs9ip5RT44isk3RYjBAhIgq7QLxihRLwLSCXbKLYlTYCNooMIjqTUm9zl5BuRw2MGu4nxfhtqQns88UMmsAWEnIjJ/BC5SelXiv0kcVCpKazF4FLgCJVQLUcvcb5ePPxrgne1/mNtmIXgJOANWrQzWCyFYgVoHoAh8IfPLyvSxgdThWYnAZcAgnsytTlUWpKdZqPfMA6KogeCeek2sofp0L2mc3RHRL3JTH2sYWfHvosqt/0EIK/28QuK4ZQar+YH30ID1xqM067mNB2iv1oBh1e/x9U5fgLEqm3kc0GwBSkKnmJi+z1C1/IwntIl/0G8rOeZCLv4ZxcYgsd/LpdRB9/2WpfN9mMWZAleMKJVFGYkWuP98/6g9azfMD7D0FlN+wuocAAAAASUVORK5CYII="},377:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAM1BMVEUAAAAAZ/8AZv8AZv8AZ/8AZv8AZv8AZv8AZv8AZv8AZv8AZv8AZv8AZf8AZv8AZv////+Fr8V6AAAAD3RSTlMAT+jmSuTh9/37/PrgR9w26QDFAAAAAWJLR0QQlbINLAAAAAd0SU1FB+YKFBM0M4OYBZ4AAAA8SURBVDjL7dKpAQAwCEPR9ITe+2/bDYJF8CxfRAAEN1J+RKloj+oQHigGDyaUB8sKBNsaeTq73xOP4McHs4IObtg7GTsAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMTAtMjBUMTk6NTI6NTErMDA6MDASOJbCAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTEwLTIwVDE5OjUyOjUxKzAwOjAwY2UufgAAAABJRU5ErkJggg=="}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.b=document.baseURI||self.location.href,n.nc=void 0;var r={};(()=>{n.r(r),n.d(r,{initStaemmeBot:()=>Be});var e=n(72),t=n.n(e),o=n(825),i=n.n(o),a=n(659),s=n.n(a),c=n(56),u=n.n(c),l=n(540),d=n.n(l),p=n(113),h=n.n(p),f=n(407),g={};g.styleTagTransform=h(),g.setAttributes=u(),g.insert=s().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=d();t()(f.A,g);f.A&&f.A.locals&&f.A.locals;var m=n(718),v={};v.styleTagTransform=h(),v.setAttributes=u(),v.insert=s().bind(null,"head"),v.domAPI=i(),v.insertStyleElement=d();t()(m.A,v);m.A&&m.A.locals&&m.A.locals;var y;!function(e){e.RUNNING="sta-running",e.AUTO_LOGIN_WORLD="sta-auto-login-world",e.LOGS="sta-logs",e.VILLAGE_DATA="sta-village-data",e.SCAVENGE_ENABLED="sta-scavenge-enabled",e.SCAVENGE_NEXT_RUN="sta-scavenge-next-run",e.SCAVENGE_KEEP_SPEAR="sta-scavenge-keep-spear",e.SCAVENGE_KEEP_SWORD="sta-scavenge-keep-sword",e.SCAVENGE_KEEP_AXE="sta-scavenge-keep-axe",e.SCAVENGE_KEEP_LIGHT="sta-scavenge-keep-light",e.SCAVENGE_KEEP_HEAVY="sta-scavenge-keep-heavy",e.CONSTRUCTION_ENABLED="sta-construction-enabled",e.CONSTRUCTION_BUILD_CODE="sta-construction-build-code",e.CONSTRUCTION_NEXT_RUN="sta-construction-next-run",e.CONSTRUCTION_PLAN_INVERTED="sta-construction-plan-inverted",e.REWARD_ENABLED="sta-reward-enabled",e.REWARD_NEXT_RUN="sta-reward-next-run",e.REPORT_ENABLED="sta-report-enabled",e.REPORT_ARCHIVE="sta-report-archive",e.REPORT_DB_USER="sta-report-db-user",e.REPORT_DB_PASSWORD="sta-report-db-password"}(y||(y={}));var b,w=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},x=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function E(e,t){localStorage.setItem(e,t)}function N(e){return localStorage.getItem(e)}function A(e){UI.SuccessMessage(e,4e3)}function _(e){UI.ErrorMessage(e,4e3)}function C(e){UI.ToolTip(e)}function S(e){return new Promise((function(t){return setTimeout(t,e)}))}function T(){return game_data}var k=null!==(b=JSON.parse(N(y.LOGS)))&&void 0!==b?b:[];function B(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e;n<r.length;n++){var o=r[n];k.push((new Date).toLocaleString("de-DE")+" - "+o)}for(var i=0;i<k.length-1e3;i++)k.shift();E(y.LOGS,JSON.stringify(k))}function R(){return k}function L(e){return w(this,void 0,void 0,(function(){return x(this,(function(t){return[2,$.get(e,(function(e){return e}))]}))}))}function D(e,t){return w(this,arguments,void 0,(function(e,t,n,r){return void 0===n&&(n="GET"),void 0===r&&(r={"Tribalwars-Ajax":1}),x(this,(function(o){return[2,$.ajax(e,{headers:r,method:n,data:t})]}))}))}function O(e){var t=Math.floor(e-Date.now()/1e3),n=Math.floor(t/60),r=Math.floor(n/60);return t-=60*n,n-=60*r,1==r.toString().length&&(r="0"+r),1==n.toString().length&&(n="0"+n),1==t.toString().length&&(t="0"+t),r+":"+n+":"+t}function P(e){var t,n;try{var r=$(e).find('script:contains("TribalWars.updateGameData")')[0].innerHTML,o=r.indexOf("TribalWars.updateGameData(")+26,i=r.indexOf(");");t=JSON.parse(r.substring(o,i))}catch(e){B("Could not find TribalWars.updateGameData")}if(!t)throw"IDK anymore";try{n=JSON.parse(N(y.VILLAGE_DATA))}catch(e){B("Error during reading Village Data, create new")}n||(n={});var a=n[t.village.id];return a||(a={resources:{},buildings:{}}),a.resources.wood=t.village.wood,a.resources.stone=t.village.stone,a.resources.iron=t.village.iron,a.units=t.units,a.name=t.village.name,a.id=t.village.id,a.storageMax=t.village.storage_max,a.features=t.features,n[a.id]=a,E(y.VILLAGE_DATA,JSON.stringify(n)),t}function I(e,t){var n,r;try{n=JSON.parse(N(y.VILLAGE_DATA))}catch(e){B("Could not load saved village data")}n||(n={}),n[t]||(n[t]={});try{var o=$(e).find('script:contains("BuildingMain.buildings")'),i=o[o.length-1].innerHTML;r=JSON.parse(i.substring(30,i.length-2))}catch(e){B("Could not find BuildingMain.buildings")}if(!r)return n[t].buildings;for(var a in T().village.buildings)n[t].buildings[a]&&(n[t].buildings[a].found=!1);for(var a in T().village.buildings){var s=r[a];if(s){var c={found:!0};c.level=s.level_next-1,c.nextLevel=s.level_next,c.maxLevel=s.max_level,c.population=s.pop,c.wood=s.wood,c.stone=s.stone,c.iron=s.iron,c.require=s.require,c.forecast=s.forecast,c.error=s.error,c.canBuild=s.can_build,n[t]||(n[t]={}),n[t].buildings?n[t].buildings[a]=c:n[t].buildings={buildingsKey:c}}}return E(y.VILLAGE_DATA,JSON.stringify(n)),n[t].buildings}var U,G=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},M=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},q=function(){function e(e){try{this.container=this.create(),this.popup=this.container.children[0],this.popup.appendChild(this.createHeader()),this.popup.appendChild(this.createContent(e))}catch(e){console.error(e)}}return e.prototype.show=function(e){return G(this,void 0,void 0,(function(){var t,n;return M(this,(function(r){for(this.container.style.display="",this.popup.style.minWidth="400px",this.popup.style.maxWidth="70vw",this.popup.style.maxHeight="80vh",this.popup.style.minHeight="260px",t=this.popup.getElementsByClassName("sta-nav")[0].children,n=0;n<t.length;n++)t[n].textContent===e&&t[n].click();return[2]}))}))},e.prototype.create=function(){var e=this,t=document.createElement("div");t.className="popup_box_container sub-dialog sta-container",document.getElementById("ds_body").appendChild(t),t.addEventListener("click",(function(){e.popup.style.minWidth="0px",e.popup.style.maxWidth="0vw",e.popup.style.maxHeight="0vh",e.popup.style.minHeight="0px",setTimeout((function(){t.style.display="none"}),500)})),t.style.display="none";var n=document.createElement("div");return n.className="popup_box slim mobile show sta-popup",t.appendChild(n),n.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation()})),t},e.prototype.createHeader=function(){var e=document.createElement("div");e.className="sta-popup-header-container";var t=document.createElement("div");t.className="sta-info",t.setAttribute("data-title","Der Bot automatisiert Aufgaben im Hintergrund, ist aber nur für die Anfangsphase empfohlen. Sobald der Account Manager freigeschalten ist bitte unbedingt wechseln!"),e.appendChild(t),UI.ToolTip(t);var n=document.createElement("h2");n.className="sta-popup-header-label",n.textContent="Bot",e.appendChild(n);var r=document.createElement("div");r.className="sta-popup-description",r.textContent="Der Bot läuft nur wenn das kleines Stammessymbol neben 'Bot' in der Menüleiste blau leuchtet, \n        klicke darauf um es umzuschalten. Dann führt er alle Aufgaben aus die hier oder über das Menü aktiviert sind.",e.appendChild(r);var o=document.createElement("div");return o.className="sta-logs",o.textContent="Kopiere logs",o.setAttribute("data-title","Kopiert die letzten Log-Einträge in die Zwischenablage, vermutlich nur für den Entwickler interessant falls es Probleme gibt. Discord: Jimmy653"),o.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation();for(var t="",n=0,r=R();n<r.length;n++){t+=r[n]+"\n"}navigator.clipboard.writeText(t).then((function(){B("Logs exported")})).catch((function(){B("Error during export of logs")}))})),e.appendChild(o),UI.ToolTip(o),e},e.prototype.createContent=function(e){var t=document.createElement("div");return t.className="sta-popup-content",t.appendChild(this.createNavItem(e,t)),t},e.prototype.createNavItem=function(e,t){var n=document.createElement("div");n.className="sta-nav";for(var r=function(e){var r=document.createElement("div");r.textContent=e.getName(),r.className="sta-nav-item",r.addEventListener("click",(function(o){if(o.preventDefault(),o.stopPropagation(),!r.className.includes("sta-nav-item-selected")){for(var i=0;i<n.children.length;i++)n.children[i].className="sta-nav-item";if(r.className+=" sta-nav-item-selected",t.children.length>1){var a=t.lastChild;a.className="sta-menu-component",a.remove()}t.appendChild(e.getComponent()),e.getComponent().className="sta-menu-component sta-fade-in"}})),n.appendChild(r)},o=0,i=e;o<i.length;o++){r(i[o])}return n},e}(),V=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},j=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},W=function(){function e(e,t){this.subscriber=[];try{this.name=e,this.settings=t,this.component=document.createElement("div"),this.component.appendChild(this.createHeader(this.name));for(var n=0,r=this.settings;n<r.length;n++){var o=r[n];this.component.appendChild(this.createSetting(o))}}catch(e){console.error(e)}}return e.prototype.isPremium=function(){return this.premium},e.prototype.setError=function(e){this.error=e},e.prototype.isError=function(){return this.error},e.prototype.getEnabledSetting=function(){return this.settings[0].setting},e.prototype.getName=function(){return this.name},e.prototype.getComponent=function(){return this.component},e.prototype.subscribe=function(e){this.subscriber.push(e)},e.prototype.invertEnabled=function(){return V(this,void 0,void 0,(function(){var e,t,n,r;return j(this,(function(o){switch(o.label){case 0:return[4,S(100)];case 1:for(o.sent(),e="true"===N(this.getEnabledSetting()),t=!e,E(this.getEnabledSetting(),t+""),n=0,r=this.subscriber;n<r.length;n++)(0,r[n])(t);return[2]}}))}))},e.prototype.createHeader=function(e){var t=document.createElement("div");return t.className="sta-menu-header",t.textContent=e,t},e.prototype.createBuildingSelector=function(){return document.createElement("div")},e.prototype.createPremium=function(e){this.premium=!0;var t=document.createElement("img");t.src="https://dsde.innogamescdn.com/asset/234518f7/graphic/premium/features/Premium_large.png",t.className="sta-feature-header-premiun-icon",t.setAttribute("data-title",e),UI.ToolTip(t);var n=document.createElement("div");n.className="sta-feature-header-premium",n.appendChild(t),T().features.Premium.active||(t.style.opacity="0.5");var r=this.component.children[0];r.remove(),n.appendChild(r),this.component.insertBefore(n,this.component.children[0])},e.prototype.createSetting=function(e){var t=document.createElement("div");return t.className="sta-menu-item-row",t.appendChild(this.createLabel(e.short)),t.appendChild(this.createInput(e)),t},e.prototype.createLabel=function(e){var t=document.createElement("div");return t.className="sta-menu-setting-label",t.textContent=e,t},e.prototype.createInput=function(e){var t=this,n=document.createElement("div");n.className="sta-labelled-input";var r=document.createElement("div");r.textContent=e.long,r.className="sta-input-label";var o=document.createElement("input");switch(o.className="sta-setting-input-"+e.setting,e.type){case"checkbox":o.type="checkbox",o.checked="true"===N(e.setting),r.className+=" clickable",o.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),t.invertEnabled()})),this.subscribe((function(e){o.checked=e})),n.addEventListener("click",(function(e){t.invertEnabled()}));break;case"numeric":o.type="text",o.inputMode="numeric",o.value=N(e.setting),o.className+=" sta-numeric-input",o.addEventListener("change",(function(t){t.preventDefault(),t.stopPropagation(),E(e.setting,o.value)}));break;case"text":o.type="text",o.value=N(e.setting),o.addEventListener("change",(function(t){t.preventDefault(),t.stopPropagation(),E(e.setting,o.value)}));break;case"password":o.type="password",o.value=N(e.setting),o.className+=" sta-password-input",o.addEventListener("change",(function(t){t.preventDefault(),t.stopPropagation(),E(e.setting,o.value)}))}return n.appendChild(o),n.appendChild(r),n},e}(),z=function(){},K=(U=function(e,t){return U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},U(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}U(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),H=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},F=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},J=function(e){function t(){var t=e.call(this,"Raubzug",[{short:"Aktiviert:",long:"Sendet die Truppen in ausgewählten Dörfern auf Raubzug, wenn der Bot läuft",setting:y.SCAVENGE_ENABLED,type:"checkbox"},{short:"Speere behalten:",long:"Anzahl der Speere die in jedem Dorf zuhause bleiben",setting:y.SCAVENGE_KEEP_SPEAR,type:"numeric"},{short:"Schwerter behalten:",long:"Anzahl der Schwerter die in jedem Dorf zuhause bleiben",setting:y.SCAVENGE_KEEP_SWORD,type:"numeric"},{short:"Äxte behalten:",long:"Anzahl der Äxte die in jedem Dorf zuhause bleiben",setting:y.SCAVENGE_KEEP_AXE,type:"numeric"},{short:"Leichte behalten:",long:"Anzahl der leichten Kavallarie die in jedem Dorf zuhause bleiben",setting:y.SCAVENGE_KEEP_LIGHT,type:"numeric"},{short:"Schwere behalten:",long:"Anzahl der schweren Kavallarie die in jedem Dorf zuhause bleiben",setting:y.SCAVENGE_KEEP_HEAVY,type:"numeric"}])||this;try{T().features.Premium.active?t.createPremium("Premium aktiv! Raubzüge werden unauffällig im Hintergrund gesendet!"):t.createPremium("Ohne Premium funktioniert dieses Feature aktuell nicht")}catch(e){console.error(e)}return t}return K(t,e),t.prototype.preRun=function(){return H(this,void 0,void 0,(function(){var e;return F(this,(function(t){return e=+N(y.SCAVENGE_NEXT_RUN),Date.now()<e?(B("".concat(this.getName()," waiting ")+O(e/1e3)),[2,!1]):[2,!0]}))}))},t.prototype.run=function(){return H(this,void 0,void 0,(function(){return F(this,(function(e){return T().features.Premium.active&&this.isPremium()?[2,this.runPremium()]:(_("Raubzug kann aktuell nicht ohne Premium ausgeführt werden. Spenden via Paypal könnten die Entwicklung beschleunigen ;)"),[2])}))}))},t.prototype.postRun=function(){E(y.CONSTRUCTION_NEXT_RUN,"0")},t.prototype.runFree=function(){return H(this,void 0,void 0,(function(){return F(this,(function(e){return[2]}))}))},t.prototype.runPremium=function(){return H(this,void 0,void 0,(function(){var e,t,n,r,o;return F(this,(function(i){return e="game.php?&screen=place&mode=scavenge_mass",t=[],n=this,$.getAll=function(e,t,n,r){var o=0,i=0;!function a(){if(o==e.length)return void n();var s=Date.now(),c=s-i;if(c<200){return void setTimeout(a,200-c)}i=s,$.get(e[o]).done((function(e){try{t(o,e),++o,a()}catch(e){r(e)}})).fail((function(e){r(e)}))}()},r=[],[2,$.get(e,(function(t){o=$(t).find(".paged-nav-item").length>0?parseInt($(t).find(".paged-nav-item")[$(t).find(".paged-nav-item").length-1].href.match(/page=(\d+)/)[1]):0;for(var n=0;n<=o;n++)r.push(e+"&page="+n)})).done((function(){var e="[";return $.getAll(r,(function(t,n){var r=$(n).find('script:contains("ScavengeMassScreen")').html().match(/\{.*\:\{.*\:.*\}\}/g)[2];r&&(e+=r+",")}),(function(){e=e.substring(0,e.length-1),e+="]";try{t=JSON.parse(e)}catch(e){return console.error(e),B("Can't work with the data"),void _("Raubzug konnte nicht geladen werden. Enthält die aktuell ausgewählte Gruppe denn Dörfer?")}return n.sendMassScavenge(t)}),(function(e){B("Error running scavenge")}))}))]}))}))},t.prototype.sendMassScavenge=function(e){return H(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,c,u;return F(this,(function(l){for(t="",n=0,r=[],o=function(o){var a=e[o],s=a.unit_counts_home.spear,c=a.unit_counts_home.sword,u=a.unit_counts_home.axe,l=a.unit_counts_home.light,d=a.unit_counts_home.heavy,p=[],h=[];$.each(a.options,(function(e){var t=a.options[e];t.is_locked||(p.push(t.base_id),null==t.scavenging_squad?h.push(t.base_id):(s+=t.scavenging_squad.unit_counts.spear,c+=t.scavenging_squad.unit_counts.sword,u+=t.scavenging_squad.unit_counts.axe,l+=t.scavenging_squad.unit_counts.light,d+=t.scavenging_squad.unit_counts.heavy,r.push(t.scavenging_squad.return_time)))}));var f=N(y.SCAVENGE_KEEP_SPEAR),g=N(y.SCAVENGE_KEEP_SWORD),m=N(y.SCAVENGE_KEEP_AXE),v=N(y.SCAVENGE_KEEP_LIGHT),b=N(y.SCAVENGE_KEEP_HEAVY);s-=Number.isNaN(f)?0:f,c-=Number.isNaN(g)?0:g,u-=Number.isNaN(m)?0:m,l-=Number.isNaN(v)?0:v,d-=Number.isNaN(b)?0:b;for(var w=a.unit_counts_home.spear,x=a.unit_counts_home.sword,E=a.unit_counts_home.axe,A=a.unit_counts_home.light,_=a.unit_counts_home.heavy,C=1;C<=4;C++){var S=a.options[C];if(h.includes(S.base_id)){var T=i.getWishedUnitCount(C,s,w,p.length,Number.isNaN(f)?0:f),k=i.getWishedUnitCount(C,c,x,p.length,Number.isNaN(g)?0:g),R=i.getWishedUnitCount(C,u,E,p.length,Number.isNaN(m)?0:m),L=i.getWishedUnitCount(C,l,A,p.length,Number.isNaN(v)?0:v),D=i.getWishedUnitCount(C,d,_,p.length,Number.isNaN(b)?0:b);T+k+R+4*L+6*D<10||(w-=T,x-=k,E-=R,A-=L,_-=D,B("Adding ".concat(a.village_name," option ").concat(S.base_id," to request")),t&&(t+="&"),t+="squad_requests%5B"+n+"%5D%5Bvillage_id%5D="+a.village_id+"&squad_requests%5B"+n+"%5D%5Bcandidate_squad%5D%5Bunit_counts%5D%5Bspear%5D="+T+"&squad_requests%5B"+n+"%5D%5Bcandidate_squad%5D%5Bunit_counts%5D%5Bsword%5D="+k+"&squad_requests%5B"+n+"%5D%5Bcandidate_squad%5D%5Bunit_counts%5D%5Baxe%5D="+R+"&squad_requests%5B"+n+"%5D%5Bcandidate_squad%5D%5Bunit_counts%5D%5Blight%5D="+L+"&squad_requests%5B"+n+"%5D%5Bcandidate_squad%5D%5Bunit_counts%5D%5Bheavy%5D="+D+"&squad_requests%5B"+n+"%5D%5Bcandidate_squad%5D%5Bcarry_max%5D=9999999999&squad_requests%5B"+n+"%5D%5Boption_id%5D="+S.base_id+"&squad_requests%5B"+n+"%5D%5Buse_premium%5D=false",n++)}}},i=this,a=0;a<e.length;a++)o(a);return n>0&&t?(s=new URLSearchParams(document.getElementById("menu_row2_village").children[0].href.split("?")[1]).get("village"),B("Sending "+n+" scavenges"),[2,fetch(window.location.origin+"/game.php?village="+s+"&screen=scavenge_api&ajaxaction=send_squads",{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"en-DE,en;q=0.9,de-DE;q=0.8,de;q=0.7,en-GB;q=0.6,en-US;q=0.5","cache-control":"no-cache","content-type":"application/x-www-form-urlencoded; charset=UTF-8",pragma:"no-cache","sec-ch-ua":'"Google Chrome";v="123", "Not:A-Brand";v="8", "Chromium";v="123"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","tribalwars-ajax":"1","x-requested-with":"XMLHttpRequest"},referrer:"https://de224.die-staemme.de/game.php?village="+s+"&screen=place&mode=scavenge_mass",referrerPolicy:"strict-origin-when-cross-origin",body:t+"&h="+T().csrf,method:"POST",mode:"cors",credentials:"include"}).then((function(e){A("".concat(n,1===n?" Raubzug wurde gestartet":" Raubzüge wurden gestartet"))})).catch((function(e){throw _("Fehler beim senden der Raubzüge"),e}))]):(c=void 0,0===r.length?c=(new Date).getTime()/1e3+3600:(r.sort((function(e,t){return e-t})),u=Math.floor(Math.random()*(r.length/25)),c=r[u]),E(y.SCAVENGE_NEXT_RUN,1e3*c+""),B("".concat(this.getName()," nothing to send...")),[2])}))}))},t.prototype.getWishedUnitCount=function(e,t,n,r,o){var i=Math.floor(t/r);return(i+=1==e?t%r:0)+ +o>n&&(i=n-+o),i<0&&(i=0),i},t}(W),Z=["main","barracks","stable","garage","church","church_f","watchtower","snob","smith","place","statue","market","wood","stone","iron","farm","storage","hide","wall"],X=["Hauptgebäude","Kaserne","Stall","Werkstatt","Kirche","Kirche","Wachturm","Adelshof","Schmiede","Versammlungsplatz","Statue","Marktplatz","Holzfällerlager","Lehmgrube","Eisenmine","Bauernhof","Speicher","Versteck","Wall"],Y=function(){function e(e){"string"==typeof e?(this.id=Z.indexOf(e),this.name=e):(this.id=e,this.name=Z[e]),this.uiName=X[this.id]}return e.prototype.getId=function(){return this.id},e.prototype.getName=function(){return this.name},e.prototype.getUiName=function(){return this.uiName},e.prototype.createIcon=function(e){var t=document.createElement("img");return t.src="https://dsde.innogamescdn.com/asset/234518f7/graphic/buildings/"+this.name+".png",t.setAttribute("data-title",this.uiName),t.className="tooltip-delayed sta-building-icon",e&&UI.ToolTip(t),t},e}(),Q=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ee=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},te=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ne=function(e){function t(t,n,r,o){var i=e.call(this,t)||this;return i.level=n,i.totalLevel=r.getLevel(),i.buildingTotal=r,i.previous=o,i}return Q(t,e),t.prototype.setNext=function(e){this.next=e},t.prototype.getNext=function(){return this.next},t.prototype.setPrevious=function(e){this.previous=e},t.prototype.getPrevious=function(){return this.previous},t.prototype.getTotalLevel=function(){return this.totalLevel},t.prototype.getLevel=function(){return this.level},t.prototype.addLevel=function(){this.level++},t.prototype.addTotalLevel=function(e){e===this.id&&(this.totalLevel++,this.buildingTotal.setLevel(this.totalLevel)),this.next&&this.next.addTotalLevel(e),this.updateUI()},t.prototype.removeLevel=function(){this.level--},t.prototype.removeTotalLevel=function(e){e===this.id&&(this.totalLevel--,this.buildingTotal.setLevel(this.totalLevel)),this.next&&this.next.removeTotalLevel(e),this.updateUI()},t.prototype.getComp=function(){return this.comp},t.prototype.updateUI=function(){this.comp.getElementsByClassName("sta-construction-entry-level")[0].textContent="+"+this.level+" (Stufe "+this.totalLevel+")"},t.prototype.paint=function(e){e&&e.level&&e.maxLevel&&e.found?e.level>=this.totalLevel?this.comp.style.backgroundColor="rgba(136,245,100,0.53)":e.maxLevel<this.totalLevel?this.comp.style.backgroundColor="rgba(245,100,100,0.53)":this.comp.style.backgroundColor="":this.comp.style.backgroundColor="rgba(161,161,161,0.53)"},t.prototype.create=function(){var e=this,t=document.createElement("div");t.className="sta-construction-entry-row sta-fade-in",this.comp=t;var n=this.createIcon(!1);n.className="sta-construction-entry-icon",t.appendChild(n);var r=document.createElement("div");r.className="sta-construction-entry-name",r.textContent=this.uiName,t.appendChild(r);var o=document.createElement("div");o.className="sta-construction-entry-level",t.appendChild(o),this.updateUI();var i=document.createElement("div");i.className="sta-construction-entry-plus",i.setAttribute("data-title","Stufe erhöhen"),UI.ToolTip(i),t.appendChild(i);var a=function(t){t.preventDefault(),e.addLevel(),e.addTotalLevel(e.id)};i.addEventListener("click",a);var s=document.createElement("div");s.className="sta-construction-entry-minus",s.setAttribute("data-title","Stufe reduzieren"),UI.ToolTip(s),t.appendChild(s);var c=function(t){t.preventDefault(),e.level<=1||(e.removeLevel(),e.removeTotalLevel(e.id))};s.addEventListener("click",c);var u=document.createElement("div");u.className="sta-construction-entry-drag",u.setAttribute("data-title","Ich hab noch nicht heraus gefunden wie das funktioniert 😭");var l=function(e){e.preventDefault()};s.addEventListener("drag",l);var d=document.createElement("div");d.className="sta-construction-entry-remove",d.setAttribute("data-title","Eintrag löschen"),UI.ToolTip(d),t.appendChild(d);var p=function(t){t.preventDefault(),d.removeEventListener("click",p),s.removeEventListener("click",c),i.removeEventListener("click",a),u.removeEventListener("click",l);for(var n=0;n<e.level;n++)e.removeTotalLevel(e.id);e.fadeOut(e.comp),e.next&&e.next.setPrevious(e.previous),e.previous&&e.previous.setNext(e.next)};return d.addEventListener("click",p),UI.ToolTip(u),t.appendChild(u),t},t.prototype.fadeOut=function(e){return ee(this,void 0,void 0,(function(){var t,n,r,o,i,a;return te(this,(function(s){switch(s.label){case 0:for(e.classList.remove("sta-fade-in"),e.className+=" sta-fade-out",t=e.parentElement,n=t.getBoundingClientRect(),r=e.getBoundingClientRect(),o=0,i=0;i<t.children.length&&t.children[i]!==e;i++)a=t.children[i].getBoundingClientRect(),o+=a.height+2;return e.style.position="absolute",e.style.top=o+"px",e.style.left=r.left-n.left+"px",e.style.width=r.width+"px",e.style.height=r.height+"px",e.style.zIndex="17000",[4,S(200)];case 1:return s.sent(),e.remove(),[2]}}))}))},t}(Y),re=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),oe=function(e){function t(t){var n=e.call(this,t)||this;return n.level=0,n}return re(t,e),t.prototype.addLevel=function(e){this.level+=e},t.prototype.setLevel=function(e){this.level=e,this.levelComp.textContent=e+""},t.prototype.getLevelComp=function(){return this.levelComp},t.prototype.getLevel=function(){return this.level},t.prototype.create=function(){var e=document.createElement("div");e.className="sta-construction-building-upgradeable",e.appendChild(this.createIcon(!0));var t=document.createElement("div");return t.className="sta-construction-building-level-upgradeable",t.textContent=this.getLevel()+"",this.levelComp=t,e.appendChild(t),e},t}(Y),ie=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ae=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},se=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ce=function(e){function t(){var t=e.call(this,"Konstruktion",[{short:"Aktiviert:",long:"Baut die ausgewählten Dörfer nach Bauplan aus, wenn der Bot läuft",setting:y.CONSTRUCTION_ENABLED,type:"checkbox"},{short:"Bauplan:",long:"Export-Code einer Konstruktions-Vorlage",setting:y.CONSTRUCTION_BUILD_CODE,type:"text"}])||this;try{t.decodeBuildplan(N(y.CONSTRUCTION_BUILD_CODE)),t.createBody(),t.runner=new ue(t)}catch(e){console.error(e)}return t}return ie(t,e),t.prototype.decodeBuildplan=function(e){var t;this.buildings=[],this.firstBuilding=void 0,this.lastBuilding=void 0,this.planName=void 0;try{t=atob(e)}catch(e){return void console.error("Ungültiger Code")}var n,r,o,i={number:oe},a=T();for(var s in a.village.buildings){i[(l=new oe(s)).getId()]=l}for(var c=2;c<t.length;c+=2)if(244!=t.charCodeAt(c)&&244!=t.charCodeAt(c+1)||128!=t.charCodeAt(c+1)&&128!=t.charCodeAt(c+4)||128!=t.charCodeAt(c+2)||128!=t.charCodeAt(c+3)||(n?(r=c,244===t.charCodeAt(c+1)&&r++):(n=c+4,244===t.charCodeAt(c+1)&&n++)),!n){var u=t.charCodeAt(c),l=i[u],d=t.charCodeAt(c+1);l||(l=new oe(u),i[u]=l),l.addLevel(d);var p=new ne(u,d,l,o);o&&o.setNext(p),o=p,this.firstBuilding||(this.firstBuilding=o)}(this.lastBuilding=o,this.firstBuilding||this.lastBuilding)||((l=i[0]).addLevel(1),this.firstBuilding=new ne(0,1,l,void 0),this.lastBuilding=this.firstBuilding);for(c=0;c<20;c++)i[c]&&this.buildings.push(i[c]);this.planName=n&&r?t.substring(n,r).trim():"Default"},t.prototype.encodeBuildplan=function(e){var t="";t+="??";for(var n=e;n;)t+=String.fromCharCode(n.getId()),t+=String.fromCharCode(n.getLevel()),n=n.getNext();t+=String.fromCharCode(244),t+=String.fromCharCode(128),t+=String.fromCharCode(128),t+=String.fromCharCode(128),t+=this.planName,t+=String.fromCharCode(244),t+=String.fromCharCode(128),t+=String.fromCharCode(128),t+=String.fromCharCode(128);var r=btoa(t.toString());E(y.CONSTRUCTION_BUILD_CODE,r);var o=this.component.getElementsByClassName("sta-setting-input-sta-construction-build-code")[0];o&&(o.value=r)},t.prototype.createBody=function(){var e=this.createHeader(this.planName);e.id="sta-buildplan-header",this.component.appendChild(e),this.component.appendChild(this.createBuildplan())},t.prototype.createBuildplan=function(){var e=this,t=document.createElement("div");return t.className="sta-construction-menu-buildplan",this.plan=this.createPlan(),t.appendChild(this.plan),t.appendChild(this.createBuildingSelector()),this.component.getElementsByClassName("sta-setting-input-sta-construction-build-code")[0].addEventListener("change",(function(n){n.preventDefault(),e.plan.remove(),e.decodeBuildplan(N(y.CONSTRUCTION_BUILD_CODE)),e.plan=e.createPlan(),t.insertBefore(e.plan,t.children[0]),document.getElementById("sta-buildplan-header").textContent=e.planName})),t},t.prototype.createPlan=function(){var e,t,n=document.createElement("div");n.className="sta-construction-plan";var r,o=document.createElement("div");o.className="sta-construction-plan-inverter",o.textContent="Liste umdrehen",n.appendChild(o),n.appendChild(this.createPlanHeader());try{r=JSON.parse(N(y.VILLAGE_DATA))}catch(e){B("Could not load saved village data")}r||(r={});var i=document.createElement("div");i.className="sta-construction-entries","true"===N(y.CONSTRUCTION_PLAN_INVERTED)&&i.classList.add("sta-construction-plan-inverted"),n.appendChild(i);for(var a=this.firstBuilding;a;)this.appendEntryToPlan(i,a,null===(t=null===(e=r[T().village.id])||void 0===e?void 0:e.buildings)||void 0===t?void 0:t[a.getName()]),a=a.getNext();return o.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),i.classList.contains("sta-construction-plan-inverted")?(E(y.CONSTRUCTION_PLAN_INVERTED,"false"),i.classList.remove("sta-construction-plan-inverted")):(E(y.CONSTRUCTION_PLAN_INVERTED,"true"),i.classList.add("sta-construction-plan-inverted"))})),n},t.prototype.appendEntryToPlan=function(e,t,n){var r=this;e.appendChild(t.create()),t.paint(n),t.getComp().getElementsByClassName("sta-construction-entry-remove")[0].addEventListener("click",(function(e){e.preventDefault(),r.lastBuilding===t&&(r.lastBuilding=t.getPrevious()),r.firstBuilding===t&&(r.firstBuilding=t.getNext())}));var o=function(e){e.preventDefault(),e.stopPropagation(),r.encodeBuildplan(r.firstBuilding)};t.getComp().getElementsByClassName("sta-construction-entry-plus")[0].addEventListener("click",o),t.getComp().getElementsByClassName("sta-construction-entry-minus")[0].addEventListener("click",o),t.getComp().getElementsByClassName("sta-construction-entry-drag")[0].addEventListener("click",o),t.getComp().getElementsByClassName("sta-construction-entry-remove")[0].addEventListener("click",o)},t.prototype.createPlanHeader=function(){var e=this,t=document.createElement("div");t.className="sta-total-level";for(var n=function(n){t.appendChild(n.create()),n.getLevelComp().addEventListener("click",(function(t){var r,o,i,a;t.preventDefault(),t.stopPropagation();var s,c=new ne(n.getId(),1,n,e.lastBuilding);e.lastBuilding&&e.lastBuilding.setNext(c),e.lastBuilding=c,e.firstBuilding||(e.firstBuilding=c);try{s=JSON.parse(N(y.VILLAGE_DATA))}catch(e){B("Could not load saved village data")}s||(s={}),e.appendEntryToPlan(e.plan.getElementsByClassName("sta-construction-entries")[0],c,null===(o=null===(r=s[T().village.id])||void 0===r?void 0:r.buildings)||void 0===o?void 0:o[n.getName()]),c.addTotalLevel(c.getId()),c.paint(null===(a=null===(i=s[T().village.id])||void 0===i?void 0:i.buildings)||void 0===a?void 0:a[n.getName()]),e.encodeBuildplan(e.firstBuilding)}))},r=0,o=this.buildings;r<o.length;r++){n(o[r])}return t},t.prototype.preRun=function(){return this.runner.preRun(this.firstBuilding)},t.prototype.run=function(){return ae(this,void 0,void 0,(function(){return se(this,(function(e){return[2,this.runner.run(this.firstBuilding)]}))}))},t.prototype.postRun=function(){this.runner.postRun()},t}(W);var ue=function(e){function t(t){var n=e.call(this)||this;return n.config=t,n}return ie(t,e),t.prototype.preRun=function(e){return ae(this,void 0,void 0,(function(){var t,n,r,o;return se(this,(function(i){if((t=new URLSearchParams(window.location.search)).has("screen")&&"main"===t.get("screen")){if(this.canFinishEarly(document))return[2,!0];if(this.isQueueFull(document))return[2,!1];if(n=P(document),r=I(document,n.village.id),this.findNextEntry(r,e))return[2,!0]}return o=+N(y.CONSTRUCTION_NEXT_RUN),Date.now()<o?(B("".concat(this.config.getName()," waiting ")+O(o/1e3)),[2,!1]):[2,!0]}))}))},t.prototype.run=function(e){return ae(this,void 0,void 0,(function(){var t;return se(this,(function(n){return(t=T()).features.Premium.active&&this.config.isPremium()?[2,this.runPremium(e)]:[2,this.runFree(e,t.village.id)]}))}))},t.prototype.postRun=function(){},t.prototype.runPremium=function(e){throw new Error("Method not implemented.")},t.prototype.canFinishEarly=function(e){try{var t=+$(e).find(".btn-instant-free")[0].getAttribute("data-available-from");if(Date.now()/1e3+180>t)return!0}catch(e){B("Could not find finish early button")}return!1},t.prototype.finishEarly=function(e){try{if(!this.canFinishEarly(e))return;var t=$(e).find(".btn-instant-free")[0].getAttribute("onclick"),n=t.indexOf("("),r=t.indexOf(")"),o=(t=t.substring(n+1,r)).split(","),i=o[1].split("'");BuildingMain.change_order(o[0],i[1],o[2])}catch(e){B("Could not finish early")}},t.prototype.runFree=function(e,t){return ae(this,void 0,void 0,(function(){var n=this;return se(this,(function(r){return[2,L("game.php?screen=main&village=".concat(t)).then((function(r){var o=new URLSearchParams(window.location.search);if(o.has("screen")&&"main"===o.get("screen")&&n.finishEarly(r),!n.isQueueFull(r)){var i=I(r,t),a=n.findNextEntry(i,e);return a?(B("Upgrading "+a.getName()),a.getComp().style.backgroundColor="rgba(77,222,255,0.53)",function(e,t){return w(this,void 0,void 0,(function(){return x(this,(function(n){return[2,$.post(e,t,(function(e){return e}))]}))}))}("/game.php?village="+t+"&screen=main&ajaxaction=upgrade_building&type=main","id="+a.getName()+"&force=1&destroy=0&source="+t+"&h=+"+T().csrf).then((function(e){A("".concat(a.getUiName()," zur Bauschleife hinzugefügt")),n.setNewRewardRun(e.date_complete)}))):(B("Nothing todo, sleep one hour for Construction"),A("Konstruktion beendet. Bitte das Feature ausschalten oder den Bauplan erweitern."),void E(y.CONSTRUCTION_NEXT_RUN,Date.now()+36e5+""))}}))]}))}))},t.prototype.setNewRewardRun=function(e){try{var t=Date.now()+e;+N(y.REWARD_NEXT_RUN)>t&&E(y.REWARD_NEXT_RUN,t+"")}catch(e){B("Could not update next reward run")}},t.prototype.isQueueFull=function(e){try{var t=$(e).find("#buildqueue")[0],n=function(e){try{var t=+JSON.parse($(e).find(".order-progress")[0].getAttribute("data-progress")).slot_end;return $(document).find(".btn-instant")[0]?t-180:t}catch(e){B("Could not find when next building finishes")}return 0}(e),r=t.children.length-2;if(t&&t.children&&r>=(T().features.Premium.active?5:2))return B("Queue full. Next building finishes in "+O(n)),E(y.CONSTRUCTION_NEXT_RUN,1e3*(n+5)+""),!0}catch(e){B("Could not read queue")}return!1},t.prototype.findNextEntry=function(e,t){for(var n=t;n;){var r=e[n.getName()];if(r)if(r.nextLevel>n.getTotalLevel())n=n.getNext();else if(r.maxLevel<r.nextLevel)n=n.getNext();else{if(r.found)return r.forecast?(B("Upgrading "+n.getName()+" to "+r.nextLevel+" in "+O(r.forecast.when)),void E(y.CONSTRUCTION_NEXT_RUN,1e3*(+r.forecast.when+5)+"")):r.error?void B("Error: '"+r.error+"' for "+n.getName()):r.canBuild?n:void 0;n=n.getNext()}else B(n.getName()+" not found - Skip"),n=n.getNext()}},t}(z),le=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),de=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},pe=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},he=function(e){function t(){var t=e.call(this,"Belohnung",[{short:"Aktiviert:",long:"Löst Belohnungen für den Ausbau von Gebäuden ein",setting:y.REWARD_ENABLED,type:"checkbox"}])||this;return t.runner=new fe,t}return le(t,e),t.prototype.preRun=function(){return this.runner.preRun()},t.prototype.run=function(){return this.runner.run()},t.prototype.postRun=function(){return this.runner.postRun()},t}(W),fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return le(t,e),t.prototype.preRun=function(){return de(this,void 0,void 0,(function(){var e,t,n;return pe(this,(function(r){return(null!==(n=this.readRewardData(null===(t=$(document).find('script:contains("RewardSystem.setRewards(")')[0])||void 0===t?void 0:t.textContent))&&void 0!==n?n:[]).length>1?[2,!0]:(e=+N(y.REWARD_NEXT_RUN),Date.now()<e?(B("Reward waiting ".concat(O(e/1e3))),[2,!1]):[2,!0])}))}))},t.prototype.readRewardData=function(e){try{if(!e)return[];var t=e.indexOf("RewardSystem.setRewards("),n=(e=e.substring(t+24)).indexOf("]");e=e.substring(0,n+1);var r=JSON.parse(e);return r.length>0&&E(y.REWARD_NEXT_RUN,"0"),r}catch(e){return B("Error reading reward data"),[]}},t.prototype.run=function(){return de(this,void 0,void 0,(function(){var e,t=this;return pe(this,(function(n){return e=T(),[2,D("game.php?village=".concat(e.village.id,"&screen=new_quests&ajax=quest_popup&tab=main-tab&quest=0")).then((function(n){return de(t,void 0,void 0,(function(){var t,r,o,i,a,s;return pe(this,(function(c){switch(c.label){case 0:t=JSON.parse(n).response.dialog,r=this.readRewardData($(t)[2].textContent),o=[],i=0,a=r,c.label=1;case 1:return i<a.length?(s=a[i],[4,S(250)]):[3,4];case 2:c.sent(),o.push(D("game.php?village=".concat(e.village.id,"&screen=new_quests&ajax=claim_reward"),"reward_id=".concat(s.id,"&h=").concat(e.csrf),"POST")),c.label=3;case 3:return i++,[3,1];case 4:return 1===r.length?A("".concat(r.length," Belohnung abgeholt")):r.length>1&&A("".concat(r.length," Belohnungen abgeholt")),[2,Promise.all(o)]}}))}))}))]}))}))},t.prototype.postRun=function(){E(y.REWARD_NEXT_RUN,Date.now()+36e5+""),E(y.CONSTRUCTION_NEXT_RUN,"0")},t}(z),ge=n(772),me={};me.styleTagTransform=h(),me.setAttributes=u(),me.insert=s().bind(null,"head"),me.domAPI=i(),me.insertStyleElement=d();t()(ge.A,me);ge.A&&ge.A.locals&&ge.A.locals;var ve=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ye=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},be=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},we=function(e){function t(){var t=e.call(this,"Berichte",[{short:"Info:",long:"Fügt den Button 'Verarbeiten' oberhalb der Berichte hinzu, \ndamit können alle Berichte der aktuellen Seite anhang folgender Einstellungen verarbeitet werden",setting:y.REPORT_ENABLED,type:"checkbox"},{short:"Archivieren:",long:"Ordner in den die Berichte verschoben werden sollen",setting:y.REPORT_ARCHIVE,type:"text"},{short:"Datenbank Benutzer:",long:"Benutzer für www.diestaemmedb.de",setting:y.REPORT_DB_USER,type:"text"},{short:"Datenbank Passwort:",long:"Passwort für www.diestaemmedb.de",setting:y.REPORT_DB_PASSWORD,type:"password"}])||this;try{var n;return(n=t.component.children[1].children[1].children[0]).disabled=!0,n.setAttribute("data-title","Noch nicht implementiert"),C(n),t}catch(e){console.error(e)}return t}return ve(t,e),t.prototype.isReportPage=function(){var e=new URLSearchParams(window.location.search);return e.has("screen")&&"report"===e.get("screen")},t.prototype.createProcessButton=function(){var e=this,t=document.createElement("button");t.textContent="Verarbeiten",t.className="btn sta-report-process",t.addEventListener("click",(function(t){return ye(e,void 0,void 0,(function(){return be(this,(function(e){switch(e.label){case 0:return t.stopPropagation(),t.preventDefault(),[4,this.run()];case 1:return e.sent(),this.postRun(),[2]}}))}))}));var n=document.getElementsByClassName("report-preview")[0].parentElement;n.insertBefore(t,n.children[0])},t.prototype.preRun=function(){return ye(this,void 0,void 0,(function(){return be(this,(function(e){return[2,!1]}))}))},t.prototype.run=function(){return ye(this,void 0,void 0,(function(){var e,t;return be(this,(function(n){return e=N(y.REPORT_DB_USER),t=N(y.REPORT_DB_USER),e&&t?this.selectAllAndPublish():_("Benutzer oder Passwort nicht gesetzt."),[2]}))}))},t.prototype.postRun=function(){},t.prototype.selectAllAndPublish=function(){return ye(this,void 0,void 0,(function(){var e;return be(this,(function(t){switch(t.label){case 0:return[4,S(100)];case 1:return t.sent(),document.getElementById("select_all").click(),[4,S(100)];case 2:return t.sent(),document.getElementsByName("forward")[0].click(),(e=new URLSearchParams(window.location.search)).has("screen")&&"report"===e.get("screen")&&e.has("mode")&&"process_reports"===e.get("mode")&&e.has("refmode")&&"all"===e.get("refmode")&&document.getElementsByClassName("btn")[0].click(),[2]}}))}))},t}(W),xe=function(){function e(){var e=this;this.features=[new we,new ce,new he,new J];try{var t=this.createMenuButton();this.addMenuEntries(t),this.popup=new q(this.features);var n="true"===N(y.RUNNING);this.updateIcon(n),t.addEventListener("click",(function(t){t.preventDefault(),t.stopPropagation();var n=!("true"===N(y.RUNNING));E(y.RUNNING,n+""),e.updateIcon(n)}))}catch(e){B("Exception during Menu.constructor"),B(e)}}return e.prototype.getFeatures=function(){return this.features},e.prototype.updateIcon=function(e){var t=document.getElementById("menuIcon");t.className=e?"icon header new_post":"icon header no_new_post"},e.prototype.createMenuButton=function(){var e=document.createElement("td");e.id="menuButton",e.className="menu-item";var t=document.getElementById("menu_row");t&&t.insertBefore(e,t.children[t.children.length-1]);var n=document.getElementById("mobileTouch");n&&n.insertBefore(e,n.children[n.children.length-1]);var r=document.createElement("span");r.id="menuIcon",r.className="icon header no_new_post";var o=document.createElement("a");return o.appendChild(r),o.id="iconContainer",o.innerHTML+=" Bot",e.appendChild(o),e},e.prototype.addMenuEntries=function(e){var t=document.createElement("table");e.appendChild(t),t.className="menu_column sta-menu-column";var n=document.createElement("tbody");t.appendChild(n);for(var r=!0,o=0,i=this.features;o<i.length;o++){var a=i[o],s=void 0,c=void 0;r?(r=!1,s="-first-child",c="sta-leftUiThingyFirstChild"):(s="",c="sta-leftUiThingy"),this.addItem(n,a,c,s)}this.addMenuBottom(n)},e.prototype.addItem=function(e,t,n,r){var o=document.createElement("tr");e.appendChild(o);var i=document.createElement("td");o.appendChild(i),i.className="menu-column-item sta-menu-column-item";var a=document.createElement("div");i.appendChild(a),a.className=n;var s=document.createElement("input");s.type="checkbox",s.className="sta-menu-item-checkbox"+r,s.checked="true"===N(t.getEnabledSetting()),s.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),t.invertEnabled()})),t.subscribe((function(e){s.checked=e}));var c=document.createElement("div");c.innerText=t.getName(),c.className="sta-menu-column-item-text"+r;var u=document.createElement("div");u.className="sta-menu-item-container",u.appendChild(s),u.appendChild(c),i.appendChild(u);var l=this;o.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),l.popup.show(t.getName())}))},e.prototype.addMenuBottom=function(e){var t=document.createElement("tr");e.appendChild(t);var n=document.createElement("td");t.appendChild(n),n.className="bottom";var r=document.createElement("div");r.className="corner sta-corner",n.appendChild(r);var o=document.createElement("div");o.className="decoration",n.appendChild(o)},e}(),Ee=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ne=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ae=function(){function e(e){var t=this;setTimeout((function(){return t.check(e)}),5e3)}return e.prototype.check=function(e){return Ee(this,void 0,void 0,(function(){var t,n,r;return Ne(this,(function(o){switch(o.label){case 0:return[4,S(1e3*Math.floor(60*Math.random()))];case 1:o.sent(),o.label=2;case 2:t=0,n=e.getFeatures(),o.label=3;case 3:return t<n.length?(r=n[t],[4,S(5e3)]):[3,9];case 4:if(o.sent(),r.isError())return B("Skipping "+r.getName()+" because of previous error"),[3,8];o.label=5;case 5:return o.trys.push([5,7,,8]),[4,this.run(r)];case 6:return o.sent()&&B(r.getName()+" ran"),[3,8];case 7:return B(o.sent()),_("Fehler bei ".concat(r.getName(),". Funktion wird deaktiviert bis die Seite neu geladen wird. Bei anhalten des Fehlers bitte Entwickler kontaktieren.")),r.setError(!0),[3,8];case 8:return t++,[3,3];case 9:return[3,0];case 10:return[2]}}))}))},e.prototype.run=function(e){return Ee(this,void 0,void 0,(function(){var t,n;return Ne(this,(function(r){switch(r.label){case 0:if("true"!==N(y.RUNNING)||"true"!==N(e.getEnabledSetting()))return[2,!1];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.preRun()];case 2:return r.sent()?[3,4]:[2,!1];case 3:throw t=r.sent(),B(e.getName()+" - Exception during preRun"),t;case 4:return r.trys.push([4,6,,7]),[4,e.run()];case 5:return r.sent(),[3,7];case 6:throw n=r.sent(),B(e.getName()+" - Exception during run"),n;case 7:try{e.postRun()}catch(t){B(e.getName()+" - Exception during postRun")}return[2,!0]}}))}))},e}(),_e=n(595),Ce={};Ce.styleTagTransform=h(),Ce.setAttributes=u(),Ce.insert=s().bind(null,"head"),Ce.domAPI=i(),Ce.insertStyleElement=d();t()(_e.A,Ce);_e.A&&_e.A.locals&&_e.A.locals;var Se=function(){function e(){try{this.autoLogin(),this.createCheckboxes()}catch(e){B("Exception during Login.constructor"),B(e)}}return e.prototype.createCheckboxes=function(){for(var e=this,t=document.getElementsByClassName("world-select"),n=function(n){var r=t[n];if("Aktuelle Welten"!==r.parentElement.children[0].textContent)return"continue";r.classList.add("sta-login-item");var o=document.createElement("input");o.type="checkbox",r.href===N(y.AUTO_LOGIN_WORLD)&&(o.checked=!0),o.addEventListener("change",(function(t){var n;o.checked?(E(y.AUTO_LOGIN_WORLD,r.href),e.autoLogin()):(n=y.AUTO_LOGIN_WORLD,localStorage.removeItem(n))})),r.insertBefore(o,r.children[0])},r=0;r<t.length;r++)n(r);var o=t[0].parentElement;o.classList.add("sta-login-parent"),o.children[0].classList.add("sta-login-header")},e.prototype.login=function(){var e=N(y.AUTO_LOGIN_WORLD);e&&(window.location.href=e)},e.prototype.autoLogin=function(){var e=this;setTimeout((function(){return e.login()}),1e3*(5*Math.random()+5))},e}(),Te=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},ke=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function Be(){return Te(this,void 0,void 0,(function(){var e,t,n,r;return ke(this,(function(o){if(window.location.origin.includes("www.die-staemme.de"))return new Se,[2];if("0"!==(e=T()).player.sitter)return console.log("Sitter mode detected - abort!"),[2];var i,a;setTimeout((function(){window.location.href=window.location.origin+"/game.php?village=".concat(e.village.id,"&screen=&action=logout&h=").concat(e.csrf)}),1e3*(i=10,a=10,60*(Math.floor(Math.random()*a)+i)*60+60*Math.floor(60*Math.random())+Math.floor(60*Math.random())));try{t=P(document)}catch(e){B("Error reading game data")}try{(n=new URLSearchParams(window.location.search)).has("screen")&&"main"===n.get("screen")&&I(document,t.village.id)}catch(e){B("Error reading village data")}return r=new xe,new Ae(r),[2]}))}))}})(),staemme=r})();